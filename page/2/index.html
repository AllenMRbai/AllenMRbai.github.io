<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.0">



  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.0.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.0">








<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.0.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="记录学习的过程">
<meta name="keywords" content="blog">
<meta property="og:type" content="website">
<meta property="og:title" content="Allen&#39;s Notes">
<meta property="og:url" content="https://allenmrbai.github.io/page/2/index.html">
<meta property="og:site_name" content="Allen&#39;s Notes">
<meta property="og:description" content="记录学习的过程">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Allen&#39;s Notes">
<meta name="twitter:description" content="记录学习的过程">






  <link rel="canonical" href="https://allenmrbai.github.io/page/2/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Allen's Notes</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Allen's Notes</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">Quik notes</h1>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://allenmrbai.github.io/2019/02/28/javascript类型转换/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="博主">
      <meta itemprop="description" content="记录学习的过程">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/javascript类型转换/" class="post-title-link" itemprop="url">javascript类型转换</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建于：2019-02-28 15:36:15" itemprop="dateCreated datePublished" datetime="2019-02-28T15:36:15+08:00">2019-02-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="更新于：2025-04-24 17:20:11" itemprop="dateModified" datetime="2025-04-24T17:20:11+08:00">2025-04-24</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>以下内容是读《YOU DON’T KNOW JS》系列的《types &amp; grammar》第 4 章节的笔记。</p>
<h2 id="抽象值运算（Abstract-Value-Operations）"><a href="#抽象值运算（Abstract-Value-Operations）" class="headerlink" title="抽象值运算（Abstract Value Operations）"></a>抽象值运算（Abstract Value Operations）</h2><p>“abstract operations” 通俗的理解就是“仅内部使用的操作”。在 ES5 specification 内定义了 9 个 abstract value operations ,其中作者重点介绍了 <code>ToString</code> <code>ToNumber</code> 和 <code>ToBoolean</code>。</p>
<h3 id="ToString"><a href="#ToString" class="headerlink" title="ToString"></a>ToString</h3><p>任何非字符串类型的值被转为 string 时，都会经过 <code>ToString</code> 的处理。</p>
<h4 id="基本类型-ToString"><a href="#基本类型-ToString" class="headerlink" title="基本类型 ToString"></a>基本类型 <code>ToString</code></h4><p>基本类型<code>ToString</code>运算的规则很简单，基本上原来什么样，转换后就是什么样的。但是需要注意特大或特小的数字转成字符串时会变成指数的形式。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>(<span class="literal">false</span>); <span class="comment">// "false"</span></span><br><span class="line"><span class="built_in">String</span>(<span class="literal">undefined</span>); <span class="comment">// "undefined"</span></span><br><span class="line"><span class="built_in">String</span>(<span class="literal">null</span>); <span class="comment">// "null"</span></span><br><span class="line"><span class="built_in">String</span>(<span class="number">10</span>); <span class="comment">// "10"</span></span><br><span class="line"><span class="built_in">String</span>(<span class="built_in">Symbol</span>(<span class="string">"hello"</span>)); <span class="comment">// "Symbol(hello)"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1.07</span> * <span class="number">1000</span> * <span class="number">1000</span> * <span class="number">1000</span> * <span class="number">1000</span> * <span class="number">1000</span> * <span class="number">1000</span> * <span class="number">1000</span>;</span><br><span class="line"><span class="built_in">String</span>(a); <span class="comment">// "1.07e21"</span></span><br></pre></td></tr></table></figure>
<h4 id="对象-ToString"><a href="#对象-ToString" class="headerlink" title="对象 ToString"></a>对象 <code>ToString</code></h4><p>一般对象的<code>ToString</code>运算会调用默认的<code>toString</code>方法（因为大部分对象原型链顶部是<code>Object.prototype</code>，它内部有<code>toString</code>方法;它会返回内部的<code>[[Class]]</code>,例如 <code>&quot;[object Object]&quot;</code>）。</p>
<p>如果重写了对象的<code>toString</code>方法，那么就调用重写后的<code>toString</code>。注意重写的<code>toString</code>方法只能返回基本数据类型，返回对象会抛出异常。</p>
<p>还有一种特殊情况就是用<code>Object.create(null)</code>创建以<code>null</code>为原型的对象。它的原型链上没有<code>toString</code>,执行<code>ToString</code>运算时会抛出异常。</p>
<h3 id="ToNumber"><a href="#ToNumber" class="headerlink" title="ToNumber"></a>ToNumber</h3><p>任何非 number 类型的值被转为 number 时，都会经过 <code>ToNumber</code> 的处理。</p>
<h4 id="基本类型-ToNumber"><a href="#基本类型-ToNumber" class="headerlink" title="基本类型 ToNumber"></a>基本类型 <code>ToNumber</code></h4><p>基本数据类型转 number 的规则如下。注意<code>null</code> 转成数字后是 0 而不<code>NaN</code>，空字符串转成数字后是 0，<code>symbol</code> 不能转数字，否则报错。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+<span class="literal">null</span>; <span class="comment">// 0</span></span><br><span class="line">+<span class="literal">undefined</span>; <span class="comment">// NaN</span></span><br><span class="line">+<span class="literal">true</span>; <span class="comment">// 1</span></span><br><span class="line">+<span class="literal">false</span>; <span class="comment">// 0</span></span><br><span class="line">+<span class="string">"5"</span>; <span class="comment">// 5</span></span><br><span class="line">+<span class="string">"5allen"</span>; <span class="comment">// NaN</span></span><br><span class="line">+<span class="string">""</span>; <span class="comment">// 0</span></span><br><span class="line">+<span class="built_in">Symbol</span>(<span class="number">10</span>); <span class="comment">// 抛出异常</span></span><br></pre></td></tr></table></figure>
<h4 id="对象-ToNumber"><a href="#对象-ToNumber" class="headerlink" title="对象 ToNumber"></a>对象 <code>ToNumber</code></h4><p>对象转 number 时，会先执行一个<code>ToPrimitive</code>的抽象值运算。执行<code>ToPrimitive</code>后返回的基本数据类型再按前面提到的基本数据类型转 number 的规则转换。</p>
<p><code>ToPrimitive</code>运算会先尝试调用<code>valueOf</code>方法，如果返回的结果是基本数据类型就返回运算结果；如果对象上没有<code>valueOf</code>方法或<code>valueOf</code>返回的结果不是基本数据类型就尝试调用<code>toString</code>方法；如果<code>toString</code>方法不存在或<code>toString</code>方法返回对象，会抛出异常。</p>
<p><code>ToPrimitive</code>抽象值运算的流程图如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">    A(start) --&gt;B&#123;valueOf存在吗&#125;</span><br><span class="line">    B --&gt;|存在| C[执行valueOf]</span><br><span class="line">    B --&gt;|不存在| F[执行valueOf]</span><br><span class="line">    C --&gt;D&#123;返回结果是基本类型吗&#125;</span><br><span class="line">    D --&gt;|是| E(返回运算结果)</span><br><span class="line">    D --&gt;|否| F&#123;toString存在吗&#125;</span><br><span class="line">    F --&gt;|存在| H[执行toString]</span><br><span class="line">    F --&gt;|不存在| G(抛出异常)</span><br><span class="line">    H --&gt;I&#123;返回结果是基本类型吗&#125;</span><br><span class="line">    I --&gt;|是| J(返回运算结果)</span><br><span class="line">    I --&gt;|否| K(抛出异常)</span><br></pre></td></tr></table></figure>
<h2 id="ToBoolean"><a href="#ToBoolean" class="headerlink" title="ToBoolean"></a>ToBoolean</h2><p>强转为<code>boolean</code>后的结果为<code>false</code>的值，称为<code>falsy value</code>。以下是所有的<code>falsy value</code>。</p>
<ul>
<li><code>undefined</code></li>
<li><code>null</code></li>
<li><code>false</code></li>
<li><code>+0</code> <code>-0</code> <code>NaN</code></li>
<li><code>&quot;&quot;</code></li>
</ul>
<p>不在以上列表中的所以其他值都是<code>truthy value</code>，也就是说其他值在强转为<code>boolean</code>后的结果都是<code>true</code>。</p>
<h2 id="显式转换（Explicit-Coercion）"><a href="#显式转换（Explicit-Coercion）" class="headerlink" title="显式转换（Explicit Coercion）"></a>显式转换（Explicit Coercion）</h2><p>我们知道很多操作会在内部对值进行转换，但是为了让自己和他人更直观地阅读代码，我们最好用显式的方式来对值进行转换。</p>
<h3 id="显式：Strings-Numbers"><a href="#显式：Strings-Numbers" class="headerlink" title="显式：Strings  Numbers"></a>显式：Strings <--> Numbers</--></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">42</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="built_in">String</span>(a);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c = <span class="string">"3.14"</span>;</span><br><span class="line"><span class="keyword">var</span> d = <span class="built_in">Number</span>(c);</span><br><span class="line"></span><br><span class="line">b; <span class="comment">// "42"</span></span><br><span class="line">d; <span class="comment">// 3.14</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">42</span>;</span><br><span class="line"><span class="keyword">var</span> b = a.toString();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c = <span class="string">"3.14"</span>;</span><br><span class="line"><span class="keyword">var</span> d = +c;</span><br><span class="line"></span><br><span class="line">b; <span class="comment">// "42"</span></span><br><span class="line">d; <span class="comment">// 3.14</span></span><br></pre></td></tr></table></figure>
<p>string 和 number 间的转换，作者认为<code>String(..)</code> <code>Number(..)</code> <code>toString()</code>这几个方法是显式的转换。<code>+ &quot;3.14&quot;</code>这种形式的转换在 js 社区内普遍也被认为是一种显式的转换，但是该方法在某些场合会让代码变得比较难以理解，例子如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> c = <span class="string">"3.14"</span>;</span><br><span class="line"><span class="keyword">var</span> d = <span class="number">5</span> + +c;</span><br><span class="line"></span><br><span class="line">d; <span class="comment">// 8.14</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> + -+(+(+-+<span class="number">1</span>)); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
<p>总结：作者推荐使用<code>Sting(..)</code> <code>Number(..)</code> <code>toString()</code>和一元操作符<code>+</code>来显示地将其他值转为 number 和 string。避免在某些会引起误解的地方使用一元操作符<code>+</code>。</p>
<h3 id="显式：Parsing-Numeric-Strings"><a href="#显式：Parsing-Numeric-Strings" class="headerlink" title="显式：Parsing Numeric Strings"></a>显式：Parsing Numeric Strings</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">"42"</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="string">"42px"</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Number</span>(a); <span class="comment">// 42</span></span><br><span class="line"><span class="built_in">parseInt</span>(a); <span class="comment">// 42</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Number</span>(b); <span class="comment">// NaN</span></span><br><span class="line"><span class="built_in">parseInt</span>(b); <span class="comment">// 42</span></span><br></pre></td></tr></table></figure>
<p>除了用<code>Number(..)</code>方法进行转换，我们还可以用<code>parseInt(..)</code>(还有它的双胞胎<code>parseFloat(..)</code>)来将其他值解析为 number。<code>parseInt(..)</code>会从左到又解析，直到碰到非数字字符;而<code>Number(..)</code>方法（或其他转换方法）转换的字符串中含非数字字符就会返回<code>NaN</code>。</p>
<p>在使用<code>parseInt(..)</code>时，作者推荐大家仅对 string 进行解析。不然<code>parseInt(..)</code>会将值先进行<code>ToString</code>操作（前面介绍过的抽象值操作），然后再进行解析；如果这样，这里面就带有隐式的转换，可能会带来意想不到的结果，例子如下。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(<span class="number">0.000008</span>); <span class="comment">// 0   ("0" from "0.000008")</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="number">0.0000008</span>); <span class="comment">// 8   ("8" from "8e-7")</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="literal">false</span>, <span class="number">16</span>); <span class="comment">// 250 ("fa" from "false")</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="built_in">parseInt</span>, <span class="number">16</span>); <span class="comment">// 15  ("f" from "function..")</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">"0x10"</span>); <span class="comment">// 16</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">"103"</span>, <span class="number">2</span>); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
<p>同时作者还提示大家，当需要解析的字符串中以<code>0x</code>开头，那么<code>parseInt(..)</code>会以十六进制的方式来解析（<code>0o</code> <code>0b</code>同理）。如果明确要以 10 进制来解析，推荐大家在<code>parseInt(..)</code>的第二个参数内传入<code>10</code>，来明确告知以 10 进制的方式解析。</p>
<p>总结：作者推荐大家仅对 string 使用<code>parseInt(..)</code>,在必要的情况下可以在第二个参数传<code>10</code>，来确保它以十进制的方式解析。</p>
<h3 id="显式：-–-gt-Boolean"><a href="#显式：-–-gt-Boolean" class="headerlink" title="显式：* –&gt; Boolean"></a>显式：* –&gt; Boolean</h3><p>和<code>String(..)</code> <code>Number(..)</code> 一样，<code>Boolean(..)</code>是一个显式的转换方式。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">"0"</span>;</span><br><span class="line"><span class="keyword">var</span> b = [];</span><br><span class="line"><span class="keyword">var</span> c = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> d = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">var</span> e = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> f = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">var</span> g = <span class="literal">undefined</span>;</span><br><span class="line"><span class="keyword">var</span> h = <span class="literal">NaN</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Boolean</span>(a); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Boolean</span>(b); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Boolean</span>(c); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Boolean</span>(d); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Boolean</span>(e); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Boolean</span>(f); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Boolean</span>(g); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Boolean</span>(h); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>虽然<code>Boolean(..)</code>是显式的方式，但在平时的开发中并不常用。就像前面提到的用一元操作符<code>+</code>将值转为 number，我们会用<code>!</code>来将值转为 boolean。<code>!</code>会将值转为 boolean，同时也反转了 boolean 的值，所以更通用的方式是<code>!!</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">"0"</span>;</span><br><span class="line"><span class="keyword">var</span> b = [];</span><br><span class="line"><span class="keyword">var</span> c = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> d = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">var</span> e = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> f = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">var</span> g = <span class="literal">undefined</span>;</span><br><span class="line"><span class="keyword">var</span> h = <span class="literal">NaN</span>;</span><br><span class="line"></span><br><span class="line">!!a; <span class="comment">// true</span></span><br><span class="line">!!b; <span class="comment">// true</span></span><br><span class="line">!!c; <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">!!d; <span class="comment">// false</span></span><br><span class="line">!!e; <span class="comment">// false</span></span><br><span class="line">!!f; <span class="comment">// false</span></span><br><span class="line">!!g; <span class="comment">// false</span></span><br><span class="line">!!h; <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>总结：作者推荐使用<code>Boolean(..)</code> <code>!!</code>来显示转化为 boolean。<code>!!</code>会在开发中比较常用。</p>
<h2 id="隐式转换（Implicit-Coercion）"><a href="#隐式转换（Implicit-Coercion）" class="headerlink" title="隐式转换（Implicit Coercion）"></a>隐式转换（Implicit Coercion）</h2><p>所有对 JavaScript 类型转换的抱怨主要来自它的隐式转换。</p>
<p>《JavaScript 语言精粹》的作者，Douglas Crockford 在很多会议和文字上表示应该避免使用 JavaScript 类型转换。但本书的作者认为 Douglas Crockford 想表达的确切意思应该是避免使用 JavaScript 的隐式转换。</p>
<p>然后作者提出以下几个问题：</p>
<blockquote>
<p>So, is implicit coercion evil? Is it dangerous? Is it a flaw in JavaScript’s design? Should we avoid it at all costs?</p>
</blockquote>
<p>大意如下：</p>
<blockquote>
<p>所以，隐式转换是魔鬼吗？它很危险吗？它是不是 JavaScript 设计上的瑕疵？我们是否要不惜一切代价避免使用它呢？</p>
</blockquote>
<p>大多数的读者会一边倒地回答”Yes!”。</p>
<p>作者认为我们需要从不同的角度去看隐式转换，否则就太狭隘了，这样会失去很多重要的细节。</p>
<p>他明确了使用隐式转换的目的是为了减少冗余的、模板化的代码，避免不必要的实现细节。</p>
<p>可以肯定的是，隐式转换内含有很多潜在的危险，我们需要学会避开那些会危害代码健壮的坑，而不是全盘抛弃隐式转换。</p>
<p>以下是隐式转换中比较好的实践。</p>
<h3 id="隐式：Strings-Numbers"><a href="#隐式：Strings-Numbers" class="headerlink" title="隐式：Strings  Numbers"></a>隐式：Strings <--> Numbers</--></h3><p><code>+</code> 操作符即可作为算数运算中的加号，也可以作为字符串的拼接符号。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">"42"</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="string">"0"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c = <span class="number">42</span>;</span><br><span class="line"><span class="keyword">var</span> d = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">a + b; <span class="comment">// "420"</span></span><br><span class="line">c + d; <span class="comment">// 42</span></span><br></pre></td></tr></table></figure>
<p>基本类型中做<code>+</code>操作：<code>+</code>两边其中一方是 string,那么执行的是字符串拼接，否则都是做算法运算。</p>
<p>含对象的<code>+</code>操作：对象都会先经过<code>ToPrimitive</code>抽象值运算得到基本类型，然后再按基本类型的规则做<code>+</code>运算。</p>
<p><code>a + &quot;&quot;</code>是我们常用的转 string 方法，但值得注意的是它和我们前面提到的显式转 string 的方法<code>String(..)</code> <code>toString</code>并不等同,例子如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  valueOf: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">42</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  toString: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">a + <span class="string">""</span>; <span class="comment">// "42"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">String</span>(a); <span class="comment">// "4"</span></span><br></pre></td></tr></table></figure>
<p>上面的例子中，<code>a</code>是一个对象，并且重写了<code>valueOf</code> <code>toString</code>方法。<code>a + &quot;&quot;</code>时，<code>a</code>要运行<code>ToPrimitive</code>运算，返回结果 42，然后再与空字符串拼接。而<code>String( a )</code>内部运行<code>ToString</code>运算，所以直接调用<code>a.toString()</code>。</p>
<p>一般情况，我们不会碰到这种陷进，除非我们在对象上重写了<code>valueOf</code>和<code>toString</code>方法。</p>
<p><code>-</code> <code>*</code> <code>/</code> 操作只可作为算数运算。所以可以用来将字符串转数字，例 <code>a - 0</code> <code>a * 1</code> <code>a / 1</code>。</p>
<p>总结：相比于 <code>String(a)</code> <code>a + &quot;&quot;</code>在开发中会更常用。</p>
<h3 id="隐式：-–-gt-Boolean"><a href="#隐式：-–-gt-Boolean" class="headerlink" title="隐式：* –&gt; Boolean"></a>隐式：* –&gt; Boolean</h3><p>以下表达式操作会隐式地将值转为<code>boolean</code>。</p>
<ul>
<li><code>if ( .. )</code></li>
<li><code>for ( .. ; .. ; .. )</code></li>
<li><code>while ( .. )</code> <code>do..while( .. )</code></li>
<li>三元运算符 <code>? :</code></li>
<li>逻辑或 <code>||</code> 逻辑与 <code>&amp;&amp;</code></li>
</ul>
<h4 id="和-amp-amp"><a href="#和-amp-amp" class="headerlink" title="|| 和 &amp;&amp;"></a><code>||</code> 和 <code>&amp;&amp;</code></h4><p>这两个运算符的结果未必一定是<code>boolean</code>，它会返回运算符两边中的一个值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">42</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="string">"abc"</span>;</span><br><span class="line"><span class="keyword">var</span> c = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">a || b; <span class="comment">// 42</span></span><br><span class="line">a &amp;&amp; b; <span class="comment">// "abc"</span></span><br><span class="line"></span><br><span class="line">c || b; <span class="comment">// "abc"</span></span><br><span class="line">c &amp;&amp; b; <span class="comment">// null</span></span><br></pre></td></tr></table></figure>
<h3 id="宽松相等-与-严格相等"><a href="#宽松相等-与-严格相等" class="headerlink" title="宽松相等== 与 严格相等==="></a>宽松相等<code>==</code> 与 严格相等<code>===</code></h3><p>严格相等：等号两边的值和类型都会进行比较；如果等号两边是对象，比较对象的引用地址。</p>
<p>宽松相等：只比较等号两边的值，如果类型不同会先转化再比较；如果等号两边是对象，比较对象的引用地址。</p>
<h4 id="宽松相等"><a href="#宽松相等" class="headerlink" title="宽松相等=="></a>宽松相等<code>==</code></h4><p>严格相等没什么好说的，最容易让人迷惑的是宽松相等<code>==</code>。大多情况下，它是瑕疵，它让代码容易出错。</p>
<p>宽松等于两边值类型不同时，其中的一边或两边会进行转换然后再进行比较。转换的规则会有点复杂，而且甚至有点迷惑性。</p>
<p>其中要比较注意的是 falsy values 间的比较。</p>
<ul>
<li><code>undefine</code> <code>null</code>两个互相宽松相等，但却不与其它 falsy values 宽松相等。</li>
<li><code>NaN</code>与所有其它值都不相等。</li>
</ul>
<p>宽松相等的规则总结：</p>
<ul>
<li>如果其中一边是对象，那么先执行<code>ToPrimitive</code>转为基本类型</li>
<li><code>boolean</code>执行<code>ToNumber</code></li>
<li>string 和 number 比较，string 要<code>ToNumber</code></li>
<li><code>null</code> <code>undefined</code>两宽松相等，和其它不宽松相等</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://allenmrbai.github.io/2019/02/28/event-loop-in-javascript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="博主">
      <meta itemprop="description" content="记录学习的过程">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/event-loop-in-javascript/" class="post-title-link" itemprop="url">event loop in javascript</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建于：2019-02-28 15:34:29" itemprop="dateCreated datePublished" datetime="2019-02-28T15:34:29+08:00">2019-02-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="更新于：2025-04-24 17:20:11" itemprop="dateModified" datetime="2025-04-24T17:20:11+08:00">2025-04-24</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>浏览器中的 event loop 和 Node.js 中的不一样，分开讨论。</p>
<h2 id="浏览器中的-event-loop"><a href="#浏览器中的-event-loop" class="headerlink" title="浏览器中的 event loop"></a>浏览器中的 event loop</h2><p>一张图看懂浏览器中的 event loop:</p>
<p><img src="https://note.youdao.com/yws/res/6030/WEBRESOURCE67b4b1f80c069e9d458173d2f4b5fdb0" alt="浏览器中的event loop"></p>
<p>这里有一个调用栈（Call Stack）、一个任务队列（Task Queue）和一个 微任务队列（Microtask Queue）。</p>
<p>异步接口根据类型可以分为宏任务（macrotask 也称 task）和微任务（microtask）。</p>
<ul>
<li>微任务：<code>Promise</code> <code>mutation observer</code></li>
<li>宏任务：<code>script</code> <code>setTimeout</code> <code>setInterval</code> <code>xhr</code> <code>UI事件</code></li>
</ul>
<h3 id="执行流程"><a href="#执行流程" class="headerlink" title="执行流程"></a>执行流程</h3><p>JavaScript 是单线程的，遇到异步接口时它并不会被阻塞，而是将异步接口的回调函数挂起，然后继续执行同步代码。</p>
<p>异步接口会在其它的线程上运行，当异步接口处理完毕，被挂起的回调函数才会被添加到对应的队列中。微任务会被添加到<code>Microtask Queue</code>,宏任务会被添加到<code>Task Queue</code>。</p>
<p>当 JavaScript 脚本（JavaScript 脚本是宏任务）执行完毕，并且调用栈为空时，就会先去取<code>Microtask Queue</code>内的回调函数放到调用栈内执行，执行完后再去取，直到清空<code>Microtask Queue</code>为止。</p>
<p>清空<code>Microtask Queue</code>后，会按情况更新 UI 界面,然后从<code>Task Queue</code>内取出一个任务放到调用栈内执行，执行完毕后按刚才的步骤去清空<code>Microtask Queue</code>,之后就是按前面的规则循环。</p>
<p>总结：浏览器会依次执行每个宏任务，每个宏任务之后会按序清空<code>Microtask Queue</code>并根据需要更新 UI。</p>
<h3 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h3><p>以下练习来自知乎内的一篇文章，参考链接在底部。</p>
<h5 id="练习一"><a href="#练习一" class="headerlink" title="练习一"></a>练习一</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.resolve()</span><br><span class="line">  .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">4</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">5</span>);</span><br><span class="line"><span class="comment">// Google Chrome v72 内运行结果</span></span><br><span class="line"><span class="comment">// 1 5 3 4 2</span></span><br></pre></td></tr></table></figure>
<h5 id="练习二"><a href="#练习二" class="headerlink" title="练习二"></a>练习二</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">  <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">4</span>);</span><br><span class="line">    resolve();</span><br><span class="line">  &#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">5</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">7</span>);</span><br><span class="line">  resolve();</span><br><span class="line">&#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">8</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">9</span>);</span><br><span class="line">  <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">11</span>);</span><br><span class="line">    resolve();</span><br><span class="line">  &#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">12</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// Google Chrome v72 内运行结果</span></span><br><span class="line"><span class="comment">// 1 7 8 2 4 5 9 11 12</span></span><br></pre></td></tr></table></figure>
<h2 id="Node-中的-event-loop"><a href="#Node-中的-event-loop" class="headerlink" title="Node 中的 event loop"></a>Node 中的 event loop</h2><p>Node.js 中的 event loop 实现和浏览器中的不同。下图是 Node 中 event loop 的实现：</p>
<p><img src="https://note.youdao.com/yws/res/6232/WEBRESOURCE62cc8eef1d6861fc872a9c8d0fd9ae17" alt="eventloop_in_node.jpg"></p>
<p>Node 中的 event loop 有多个阶段，每个阶段都有对应的任务队列（Task Queue）。如图所示有：</p>
<ul>
<li><code>expired timers/intervals queue</code>：即到期的 <code>setTimeout</code>和<code>setInterval</code></li>
<li><code>IO events queue</code>：包括文件读取、网络等 IO 操作</li>
<li><code>immediates queue</code>：通过<code>setImmediate</code>注册的函数</li>
<li><code>close handlers queue</code>： 各种资源关闭的回调函数，比如 TCP 连接断开</li>
</ul>
<p>Node 中的微任务队列（Microtask Queue）也不只一个，每个 event loop 阶段之后会清空所有的微任务队列,如图所示有：</p>
<ul>
<li><code>next tick queue</code>： 通过<code>process.nextTick</code>注册的函数，优先被清空</li>
<li><code>other micro tasks queue</code>： 其它微任务，常见的如<code>Promise</code></li>
</ul>
<p>Node 中异步接口</p>
<ul>
<li>微任务：<code>Promise</code> <code>process.nextTick</code></li>
<li>宏任务：<code>script</code> <code>setTimeout</code> <code>setInterval</code> <code>setImmediate</code> 各类 IO 相关的异步接口 和 各类资源关闭的异步接口</li>
</ul>
<h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><p>按顺序执行每个阶段，每个阶段会清空对应的任务队列（Task Queue），每个阶段之后会清空微任务队列(先<code>next tick queue</code>再<code>other micro tasks queue</code>)</p>
<p>与浏览器的 event loop 不同的地方：</p>
<ul>
<li>清空每个阶段对应的任务队列后再清空微任务队列</li>
<li>有多个任务队列和微任务队列</li>
</ul>
<h3 id="练习-1"><a href="#练习-1" class="headerlink" title="练习"></a>练习</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">  <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">4</span>);</span><br><span class="line">    resolve();</span><br><span class="line">  &#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">5</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  process.nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">7</span>);</span><br><span class="line">  resolve();</span><br><span class="line">&#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">8</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">process.nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">6</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">9</span>);</span><br><span class="line">  process.nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">10</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">11</span>);</span><br><span class="line">    resolve();</span><br><span class="line">  &#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">12</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// node v10.15.1</span></span><br><span class="line"><span class="comment">// 1 7 6 8 2 4 9 11 3 10 5 12</span></span><br></pre></td></tr></table></figure>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li>知乎文章<a href="https://zhuanlan.zhihu.com/p/33087629" target="_blank" rel="noopener">《Event Loop 的规范和实现》</a>，大量参考了这篇文章。</li>
<li>掘金小册<a href="https://juejin.im/book/5bdc715fe51d454e755f75ef" target="_blank" rel="noopener">《前端面试之道》</a>的第七章节《Event Loop》</li>
<li><a href="https://jakearchibald.com/2015/tasks-microtasks-queues-and-schedules/" target="_blank" rel="noopener">Tasks, microtasks, queues and schedules</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://allenmrbai.github.io/2019/02/28/Linux中格式化输出/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="博主">
      <meta itemprop="description" content="记录学习的过程">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/Linux中格式化输出/" class="post-title-link" itemprop="url">Linux中格式化输出</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建于：2019-02-28 15:32:55" itemprop="dateCreated datePublished" datetime="2019-02-28T15:32:55+08:00">2019-02-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="更新于：2025-04-24 17:20:11" itemprop="dateModified" datetime="2025-04-24T17:20:11+08:00">2025-04-24</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><ul>
<li>格式化打印：printf</li>
<li>数据处理工具：awk</li>
<li>文件对比工具：diff cmp patch</li>
<li>文件打印：pr</li>
</ul>
<h4 id="格式化打印：printf"><a href="#格式化打印：printf" class="headerlink" title="格式化打印：printf"></a>格式化打印：printf</h4><p>我们在 bash 中想输出一个表格，但由于每个字段的长度不同，会导致输出的样子像下面这样，很乱，不方便看。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># printf.txt</span></span><br><span class="line">Name Chinese English Math Average</span><br><span class="line">DmTsai 80 60 92 77.33</span><br><span class="line">VBird 75 55 80 70.00</span><br><span class="line">Ken 60 90 70 73.33</span><br></pre></td></tr></table></figure>
<p>我们想让表格格式化成下面那样，我们就可以用 printf 命令了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Name   Chinese  English  Math  Average</span><br><span class="line">DmTsai 80       60       92    77.33</span><br><span class="line">VBird  75       55       80    70.00</span><br><span class="line">Ken    60       90       70    73.33</span><br></pre></td></tr></table></figure>
<p>用法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span> <span class="string">'打印格式'</span> 实际内容</span><br><span class="line"><span class="comment">#选项与参数：</span></span><br><span class="line"><span class="comment">#关于格式方面的几个特殊样式：</span></span><br><span class="line"><span class="comment">#   \a 警告声音输出</span></span><br><span class="line"><span class="comment">#   \b 倒退键（backspace）</span></span><br><span class="line"><span class="comment">#   \f 清除屏幕 （form feed）</span></span><br><span class="line"><span class="comment">#   \n 输出新的一行</span></span><br><span class="line"><span class="comment">#   \r 亦即 Enter 按键</span></span><br><span class="line"><span class="comment">#   \t 水平的 [tab] 按键</span></span><br><span class="line"><span class="comment">#   \v 垂直的 [tab] 按键</span></span><br><span class="line"><span class="comment">#   \xNN NN 为两位数的数字，可以转换数字成为字符。</span></span><br><span class="line"><span class="comment">#关于 C 程序语言内，常见的变量格式</span></span><br><span class="line"><span class="comment">#   %ns 那个 n 是数字， s 代表 string ，亦即多少个字符；</span></span><br><span class="line"><span class="comment">#   %ni 那个 n 是数字， i 代表 integer ，亦即多少整数码数；</span></span><br><span class="line"><span class="comment">#   %N.nf 那个 n 与 N 都是数字， f 代表 floating （浮点），如果有小数码数，假设我共要十个位数，但小数点有两位，即为 %10.2f 啰！</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#例 将刚才的print.txt格式换成好看的表格</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">'%s\t %s\t %s\t %s\t %s\t \n'</span> $(cat printf.txt)</span><br><span class="line"></span><br><span class="line"><span class="comment">#例 将刚才的print.txt的标题去掉，并将每列固定长度</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">'%10s %5i %5i %5i %8.2f \n'</span> $(cat printf.txt | grep -v Name)</span><br></pre></td></tr></table></figure>
<p>printf 另一个用处是将 16 进制显示为 ASCII</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#例</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">'\x45\n'</span></span><br></pre></td></tr></table></figure>
<h4 id="数据处理工具：awk"><a href="#数据处理工具：awk" class="headerlink" title="数据处理工具：awk"></a>数据处理工具：awk</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'条件类型1&#123;动作1&#125; 条件类型2&#123;动作2&#125; ...'</span> filename</span><br></pre></td></tr></table></figure>
<p>内置变量</p>
<table>
<thead>
<tr>
<th>变量名</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td>NF</td>
<td>每一行 （\$0） 拥有的字段总数</td>
</tr>
<tr>
<td>NR</td>
<td>目前 awk 所处理的是“第几行”数据</td>
</tr>
<tr>
<td>FS</td>
<td>目前的分隔字符，默认是空白键</td>
</tr>
<tr>
<td>\$N</td>
<td>第几个字段</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#例</span></span><br><span class="line">last -n | awk <span class="string">'&#123;print $1 "\t lines:" NR "\t columns:" NF&#125;'</span></span><br></pre></td></tr></table></figure>
<p>BEGIN 和 END</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#例 awk默认分隔符是空格，但现在我们想改成‘:’。我们可以设置FS为‘:’。但下面这样写只有第二行开始生效。</span></span><br><span class="line">cat /etc/passwd | awk <span class="string">'&#123;FS=":"&#125; $3 &lt; 10 &#123;print $1 "\t " $3&#125;</span></span><br><span class="line"><span class="string">#例 为了让它从第一行就开始生效。可以用BEGIN关键字</span></span><br><span class="line"><span class="string">cat /etc/passwd | awk '</span>BEGIN &#123;FS=<span class="string">":"</span>&#125; <span class="variable">$3</span> &lt; 10 &#123;<span class="built_in">print</span> <span class="variable">$1</span> <span class="string">"\t "</span> <span class="variable">$3</span>&#125;<span class="string">'</span></span><br></pre></td></tr></table></figure>
<p>awk 还可以对表内的数据做处理。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pay.txt</span></span><br><span class="line">Name 1st 2nd 3th</span><br><span class="line">VBird 23000 24000 25000</span><br><span class="line">DMTsai 21000 20000 23000</span><br><span class="line">Bird2 43000 42000 41000</span><br></pre></td></tr></table></figure>
<p>假设我们有上面那个表(pay.txt)，想添加一列 Total 做求和。我们可以这样写</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下面的‘&gt;’表示换行。在一个动作内写多个命令可以用回车或‘;’隔开。而且这里定义的total变量可以直接使用，不需要要‘$’</span></span><br><span class="line">cat pay.txt | \</span><br><span class="line">&gt;awk <span class="string">'NR==1&#123;printf "%10s %10s %10s %10s %10s\n",$1,$2,$3,$4,"Total" &#125;</span></span><br><span class="line"><span class="string">&gt; NR&gt;=2&#123;total = $2 + $3 + $4</span></span><br><span class="line"><span class="string">&gt; printf "%10s %10d %10d %10d %10.2f\n", $1, $2, $3, $4, total&#125;'</span></span><br></pre></td></tr></table></figure>
<p>awk 动作内{}是支持 if 的，上面的命令也可以写成下面那样</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat pay.txt &amp;<span class="comment">#124; \</span></span><br><span class="line">&gt; awk <span class="string">'&#123;if（NR==1） printf "%10s %10s %10s %10s %10s\n",$1,$2,$3,$4,"Total"&#125;</span></span><br><span class="line"><span class="string">&gt; NR&amp;gt;=2&#123;total = $2 + $3 + $4</span></span><br><span class="line"><span class="string">&gt; printf "%10s %10d %10d %10d %10.2f\n", $1, $2, $3, $4, total&#125;'</span></span><br></pre></td></tr></table></figure>
<h4 id="文件对比工具：diff-cmp-patch"><a href="#文件对比工具：diff-cmp-patch" class="headerlink" title="文件对比工具：diff cmp patch"></a>文件对比工具：diff cmp patch</h4><h5 id="diff"><a href="#diff" class="headerlink" title="diff"></a>diff</h5><p>diff 是比较两个文件间的差异，并以行为单位进行比较。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用法</span></span><br><span class="line">diff [-bBi] from-file to-file</span><br><span class="line"><span class="comment">#选项与参数：</span></span><br><span class="line"><span class="comment">#from-file ：一个文件名，作为原始比对文件的文件名；</span></span><br><span class="line"><span class="comment">#to-file ：一个文件名，作为目的比对文件的文件名；</span></span><br><span class="line"><span class="comment">#注意，from-file 或 to-file 可以 - 取代，那个 - 代表“Standard input”之意。</span></span><br><span class="line"><span class="comment">#-b ：忽略一行当中，仅有多个空白的差异（例如 "about me" 与 "about me" 视为相同</span></span><br><span class="line"><span class="comment">#-B ：忽略空白行的差异。</span></span><br><span class="line"><span class="comment">#-i ：忽略大小写的不同。</span></span><br></pre></td></tr></table></figure>
<p>现在有 passwd.old passwd.new 文件。passwd.old 拷贝自/etc/passwd;passwd.new 是在/etc/passwd 的基础上做了修。删除了第四行，并将第六行替换为‘no six line’。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /tmp/testpw</span><br><span class="line"><span class="built_in">cd</span> /tmp/testpw</span><br><span class="line">cp /etc/passwd passwd.old</span><br><span class="line">cat /etc/passwd | sed -e <span class="string">'4d'</span> -e <span class="string">'6c no six line'</span> &gt; passwd.new</span><br></pre></td></tr></table></figure>
<p>现在我们可以查看新旧的 passwd 的差别了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">diff passwd.old passwd.new</span><br></pre></td></tr></table></figure>
<p>diff 还以可以比较两目录下的文件名</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">diff /etc/rc0.d/ /etc/rc5.d/</span><br></pre></td></tr></table></figure>
<h5 id="cmp"><a href="#cmp" class="headerlink" title="cmp"></a>cmp</h5><p>对比两文件，以字节的地位对比，默认仅会输出第一个发现的不同点。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用法</span></span><br><span class="line">cmp [-l] file1 file2</span><br><span class="line"><span class="comment">#选项与参数：</span></span><br><span class="line"><span class="comment">#-l ：将所有的不同点的字节处都列出来。因为 cmp 默认仅会输出第一个发现的不同点。</span></span><br></pre></td></tr></table></figure>
<h5 id="patch"><a href="#patch" class="headerlink" title="patch"></a>patch</h5><p>该命令可以用来做打补丁的用途，也可以将文件回退到补丁前的状态。<br>centOS7 默认没有安装 patch 文件，我们需要自己安装。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">su - <span class="comment">#切换到root账户</span></span><br><span class="line">mount /dev/sr0 /mnt <span class="comment">#将安装光盘挂载到/mnt</span></span><br><span class="line">rpm -ivh /mnt/Packages/patch-2.*</span><br><span class="line">umount /mnt</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>
<p>用法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#更新</span></span><br><span class="line">patch -pN &lt; patch_file</span><br><span class="line"><span class="comment">#还原</span></span><br><span class="line">patch -R -pN &lt; patch_file</span><br></pre></td></tr></table></figure>
<p>制作补丁文件。以上面的 passwd.old 和 passwd.new 为例。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#制作补丁文件</span></span><br><span class="line">diff -Naur passwd.old passwd.new &gt; passwd.patch</span><br><span class="line"><span class="comment">#将刚刚制作出来的 patch file 用来更新旧版数据</span></span><br><span class="line">patch -p0 &lt; passwd.patch</span><br><span class="line"><span class="comment">#恢复旧文件的内容</span></span><br><span class="line">patch -R -p0 &lt; passwd.patch</span><br></pre></td></tr></table></figure>
<h4 id="文件打印：pr"><a href="#文件打印：pr" class="headerlink" title="文件打印：pr"></a>文件打印：pr</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#打印/etc/man_db.conf</span></span><br><span class="line">pr /etc/man_db.conf</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://allenmrbai.github.io/2019/02/28/Linux中的正则/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="博主">
      <meta itemprop="description" content="记录学习的过程">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/Linux中的正则/" class="post-title-link" itemprop="url">Linux中的正则</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建于：2019-02-28 15:32:10" itemprop="dateCreated datePublished" datetime="2019-02-28T15:32:10+08:00">2019-02-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="更新于：2025-04-24 17:20:11" itemprop="dateModified" datetime="2025-04-24T17:20:11+08:00">2025-04-24</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>linux 中的正则有特殊符号，其他的内容和 javascript 中都相同。注意语系会对正则产生影响，一般使用与 POSIX 相容的语系。<br>特殊符号 | 意义<br>—|—<br>[:alnum:] | 代表英文大小写字符及数字，亦即 0-9, A-Z, a-z<br>[:alpha:] | 代表任何英文大小写字符，亦即 A-Z, a-z<br>[:blank:] | 代表空白键与 [Tab] 按键两者<br>[:cntrl:] | 代表键盘上面的控制按键，亦即包括 CR, LF, Tab, Del.. 等等<br>[:digit:] | 代表数字而已，亦即 0-9<br>[:graph:] | 除了空白字符 （空白键与 [Tab] 按键） 外的其他所有按键<br>[:lower:] | 代表小写字符，亦即 a-z<br>[:print:] | 代表任何可以被打印出来的字符<br>[:punct:] | 代表标点符号 （punctuation symbol），亦即：” ‘ ? ! ; : # \$…<br>[:upper:] | 代表大写字符，亦即 A-Z<br>[:space:] | 任何会产生空白的字符，包括空白键, [Tab], CR 等等<br>[:xdigit:] | 代表 16 进位的数字类型，因此包括： 0-9, A-F, a-f 的数字与字符</p>
<h3 id="带正则功能的命令"><a href="#带正则功能的命令" class="headerlink" title="带正则功能的命令"></a>带正则功能的命令</h3><p>并不是所有命令都能使用正则，只有支持正则的命令和程序才可以使用。</p>
<h5 id="1-grep-的一些进阶选项"><a href="#1-grep-的一些进阶选项" class="headerlink" title="1.grep 的一些进阶选项"></a>1.grep 的一些进阶选项</h5><ul>
<li>用法</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">grep [-A] [-B] [--color=auto] <span class="string">'搜寻字串'</span> filename</span><br><span class="line"><span class="comment">#选项与参数：</span></span><br><span class="line"><span class="comment">#-A ：后面可加数字，为 after 的意思，除了列出该行外，后续的 n 行也列出来；</span></span><br><span class="line"><span class="comment">#-B ：后面可加数字，为 befer 的意思，除了列出该行外，前面的 n 行也列出来；</span></span><br><span class="line"><span class="comment">#--color=auto 可将正确的那个撷取数据列出颜色</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#用 dmesg 列出核心讯息，再以 grep 找出内含 qxl 那行(鸟哥用的是QXL虚拟显卡，大家可能会搜不到)</span></span><br><span class="line">dmesg | grep <span class="string">'qxl'</span></span><br><span class="line"><span class="comment">#承上题，要将捉到的关键字显色，且加上行号来表示</span></span><br><span class="line">dmsg | grep -n --color=auto <span class="string">'qxl'</span></span><br><span class="line"><span class="comment">#承上题，在关键字所在行的前两行与后三行也一起捉出来显示</span></span><br><span class="line">dmesg | grep -n -A3 -B2 --color=auto <span class="string">'qxl'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例子</li>
</ul>
<p>鸟哥提供了一个练习用的文件：<a href="http://linux.vbird.org/linux_basic/0330regularex/regular_express.txt" target="_blank" rel="noopener">regular_express.txt</a></p>
<p>内容如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&quot;Open Source&quot; is a good mechanism to develop programs.</span><br><span class="line">apple is my favorite food.</span><br><span class="line">Football game is not use feet only.</span><br><span class="line">this dress doesn&apos;t fit me.</span><br><span class="line">However, this dress is about $ 3183 dollars.^M</span><br><span class="line">GNU is free air not free beer.^M</span><br><span class="line">Her hair is very beauty.^M</span><br><span class="line">I can&apos;t finish the test.^M</span><br><span class="line">Oh! The soup taste good.^M</span><br><span class="line">motorcycle is cheap than car.</span><br><span class="line">This window is clear.</span><br><span class="line">the symbol &apos;*&apos; is represented as start.</span><br><span class="line">Oh! My god!</span><br><span class="line">The gd software is a library for drafting programs.^M</span><br><span class="line">You are the best is mean you are the no. 1.</span><br><span class="line">The world &amp;lt;Happy&amp;gt; is the same with &quot;glad&quot;.</span><br><span class="line">I like dog.</span><br><span class="line">google is the best tools for search keyword.</span><br><span class="line">goooooogle yes!</span><br><span class="line">go! go! Let&apos;s go.</span><br><span class="line"># I am VBird</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查找‘the’并带上行号</span></span><br><span class="line">grep -n <span class="string">'the'</span> regular_express.txt</span><br><span class="line"><span class="comment">#查找没有‘the’的行，并带上行号，这里的v相当于相反</span></span><br><span class="line">grep -vn <span class="string">'the'</span> regular_express.txt</span><br><span class="line"><span class="comment">#忽略大小写</span></span><br><span class="line">grep -<span class="keyword">in</span> <span class="string">'the'</span> regular_express.txt</span><br><span class="line"><span class="comment">#搜索含tast或test的行</span></span><br><span class="line">grep -n <span class="string">'t[ae]st'</span> regular_express.txt</span><br><span class="line"><span class="comment">#搜索带有‘oo’并且前一个字符不为小写字母</span></span><br><span class="line">grep -n <span class="string">'[^[:lower:]]oo'</span> regular_express.txt</span><br><span class="line"><span class="comment">#搜索啥都没有的一行</span></span><br><span class="line">grep -n <span class="string">'^$'</span> regular_express.txt</span><br><span class="line"><span class="comment">#搜索非空行和开头不为‘#’的行</span></span><br><span class="line">grep -v <span class="string">'^$'</span> /etc/rsyslog.conf &amp;<span class="comment">#124; grep -v '^#'</span></span><br></pre></td></tr></table></figure>
<h5 id="2-sed-工具"><a href="#2-sed-工具" class="headerlink" title="2.sed 工具"></a>2.sed 工具</h5><p>sed 是一个管线命令，可以将数据进行取代、删除、新增、攫取。</p>
<ul>
<li>用法</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">sed [-nefr] [动作]</span><br><span class="line"><span class="comment">#选项与参数：</span></span><br><span class="line"><span class="comment">#-n ：使用安静（silent）模式。在一般 sed 的用法中，所有来自 STDIN 的数据一般都会被列出到屏幕上。但如果加上 -n 参数后，则只有经过 sed 特殊处理的那一行（或者动作）才会被列出来。</span></span><br><span class="line"><span class="comment">#-e ：直接在命令行界面上进行 sed 的动作编辑；</span></span><br><span class="line"><span class="comment">#-f ：直接将 sed 的动作写在一个文件内， -f filename 则可以执行 filename 内的 sed 动作；</span></span><br><span class="line"><span class="comment">#-r ：sed 的动作支持的是延伸型正则表达式的语法。（默认是基础正则表达式语法）</span></span><br><span class="line"><span class="comment">#-i ：直接修改读取的文件内容，而不是由屏幕输出。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#动作说明： [n1[,n2]]function</span></span><br><span class="line"><span class="comment">#n1, n2 ：不见得会存在，一般代表“选择进行动作的行数”，举例来说，如果我的动作是需要在 10 到 20 行之间进行的，则“ 10,20[动作行为] ”</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#function 有下面这些咚咚：</span></span><br><span class="line"><span class="comment">#a ：新增， a 的后面可以接字串，而这些字串会在新的一行出现（目前的下一行）～</span></span><br><span class="line"><span class="comment">#c ：取代， c 的后面可以接字串，这些字串可以取代 n1,n2 之间的行！</span></span><br><span class="line"><span class="comment">#d ：删除，因为是删除啊，所以 d 后面通常不接任何咚咚；</span></span><br><span class="line"><span class="comment">#i ：插入， i 的后面可以接字串，而这些字串会在新的一行出现（目前的上一行）；</span></span><br><span class="line"><span class="comment">#p ：打印，亦即将某个选择的数据印出。通常 p 会与参数 sed -n 一起运行～</span></span><br><span class="line"><span class="comment">#s ：取代，可以直接进行取代的工作哩！通常这个 s 的动作可以搭配正则表达式！例如 1,20s/old/new/g 就是啦！</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#删除2-5行的内容</span></span><br><span class="line">nl /etc/passwd | sed <span class="string">'2,5d'</span></span><br><span class="line"><span class="comment">#在第二行后添加‘drink tea?’</span></span><br><span class="line">nl /etc/passwd &amp;<span class="comment">#124; sed '2a drink tea'</span></span><br><span class="line"><span class="comment">#将2-5行的内容取代为‘No 2-5 number’</span></span><br><span class="line">nl /etc/passwd | sed <span class="string">'2,5c No 2-5 number'</span></span><br><span class="line"><span class="comment">#仅列出 /etc/passwd 文件内的第 5-7 行</span></span><br><span class="line">nl /etc/passwd | sed -n <span class="string">'5,7p'</span></span><br></pre></td></tr></table></figure>
<p>sed 不仅可以进行行的处理，还可以进行部分数据的搜索并取代的功能。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#使用方法</span></span><br><span class="line">sed <span class="string">'s/要被取代的字串/新的字串/g'</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">/sbin/ifconfig eth0 | grep <span class="string">'inet '</span> | sed <span class="string">'s/^.*inet //g'</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://allenmrbai.github.io/2019/02/28/vim的使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="博主">
      <meta itemprop="description" content="记录学习的过程">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/vim的使用/" class="post-title-link" itemprop="url">vim的使用</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建于：2019-02-28 15:31:20" itemprop="dateCreated datePublished" datetime="2019-02-28T15:31:20+08:00">2019-02-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="更新于：2025-04-24 17:20:11" itemprop="dateModified" datetime="2025-04-24T17:20:11+08:00">2025-04-24</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>vim 一共分三种模式：</p>
<ul>
<li>命令模式(command mode)</li>
<li>编辑模式(insert mode)</li>
<li>命令行模式(command-line mode)</li>
</ul>
<p>命令模式又被称为一般模式，进入 vim 时默认为命令模式。命令模式下按 i 可进入编辑模式，编辑模式下按 Esc 可进入命令模式。命令模式下输入“:”能进入命令行模式，命令行模式也能进入命令模式。但是命令行模式和编辑模式不能直接切换，必须经过命令模式才可。</p>
<p>每个模式都有其特有的命令和功能。</p>
<ul>
<li>命令模式可以做浏览，删除等操作</li>
<li>编辑模式可以输入内容</li>
<li>命令行模式可以保持，退出等操作</li>
</ul>
<h5 id="命令模式-command-mode"><a href="#命令模式-command-mode" class="headerlink" title="命令模式(command mode)"></a>命令模式(command mode)</h5><h6 id="移动光标"><a href="#移动光标" class="headerlink" title="移动光标"></a>移动光标</h6><table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>h(或 left)</td>
<td>左移动</td>
</tr>
<tr>
<td>j(或 down)</td>
<td>下移动</td>
</tr>
<tr>
<td>k(或 top)</td>
<td>上移动</td>
</tr>
<tr>
<td>l(或 right)</td>
<td>下移动</td>
</tr>
<tr>
<td>n(数字)+h \</td>
<td>j \</td>
<td>k \</td>
<td>l</td>
<td>移动 n 个位置</td>
</tr>
<tr>
<td>PageDown 或^f</td>
<td>向下移一页</td>
</tr>
<tr>
<td>PageUp 或^b</td>
<td>向上移一页</td>
</tr>
<tr>
<td>^d</td>
<td>向上移半页</td>
</tr>
<tr>
<td>^u</td>
<td>向上移半页</td>
</tr>
<tr>
<td>+</td>
<td>光标移动到非空白字符的下一列头部</td>
</tr>
<tr>
<td>-</td>
<td>光标移动到非空白字符的上一列头部</td>
</tr>
<tr>
<td>Home 或 0</td>
<td>到列的头部</td>
</tr>
<tr>
<td>End 或\$</td>
<td>到列的尾部</td>
</tr>
<tr>
<td>^Home</td>
<td>到文件头部</td>
</tr>
<tr>
<td>^End</td>
<td>到文件尾部</td>
</tr>
<tr>
<td>H</td>
<td>到屏幕的首行</td>
</tr>
<tr>
<td>M</td>
<td>到屏幕的中间行</td>
</tr>
<tr>
<td>L</td>
<td>到屏幕的尾行</td>
</tr>
<tr>
<td>G</td>
<td>到文件的尾行类似^End</td>
</tr>
<tr>
<td>nG</td>
<td>到文件的第 n 行</td>
</tr>
<tr>
<td>gg</td>
<td>到文件的头部类似^Home</td>
</tr>
</tbody>
</table>
<h6 id="区块选择"><a href="#区块选择" class="headerlink" title="区块选择"></a>区块选择</h6><table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>v</td>
<td>以字符为单位选择区块</td>
</tr>
<tr>
<td>V</td>
<td>以列为单位选择区块</td>
</tr>
<tr>
<td>^v</td>
<td>以矩形的形式选择区块</td>
</tr>
<tr>
<td>y</td>
<td>复制区块</td>
</tr>
<tr>
<td>p</td>
<td>粘贴区块</td>
</tr>
<tr>
<td>d</td>
<td>删除区块</td>
</tr>
</tbody>
</table>
<h6 id="搜索与取代"><a href="#搜索与取代" class="headerlink" title="搜索与取代"></a>搜索与取代</h6><table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>/word</td>
<td>向下查找</td>
</tr>
<tr>
<td>?word</td>
<td>向上查找</td>
</tr>
<tr>
<td>n</td>
<td>下一个</td>
</tr>
<tr>
<td>N</td>
<td>前一个</td>
</tr>
<tr>
<td>:n1,n2s/word1/word2/g</td>
<td>将 n1 列到 n2 列的 word1 替换为 word2</td>
</tr>
<tr>
<td>:1,\$s/word1/word2/g</td>
<td>将第一列到最后一列的 word1 替换为 word2</td>
</tr>
<tr>
<td>:1,\$s/word1/word2/gc</td>
<td>将第一列到最后一列的 word1 替换为 word2,并提示使用者是否替代</td>
</tr>
</tbody>
</table>
<h6 id="删除、复制、粘贴、撤销、恢复"><a href="#删除、复制、粘贴、撤销、恢复" class="headerlink" title="删除、复制、粘贴、撤销、恢复"></a>删除、复制、粘贴、撤销、恢复</h6><table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>x</td>
<td>向后删除，类似编辑模式的 Del</td>
</tr>
<tr>
<td>X</td>
<td>向前删除,类似编辑模式的 backspace</td>
</tr>
<tr>
<td>nx \</td>
<td>nX</td>
<td>n 为数字，表示删除 n 个</td>
</tr>
<tr>
<td>dd</td>
<td>删除光标所在行</td>
</tr>
<tr>
<td>ndd</td>
<td>删除光标所在行开始的 n 行</td>
</tr>
<tr>
<td>d1G</td>
<td>删除光标所在行到文件第一行间的所有内容</td>
</tr>
<tr>
<td>dG</td>
<td>删除光标所在行到文件最后一行间的所有内容</td>
</tr>
<tr>
<td>d\$</td>
<td>删除光标到改行结尾间的内容</td>
</tr>
<tr>
<td>d0</td>
<td>删除光标到改行头部间的内容</td>
</tr>
<tr>
<td>yy</td>
<td>复制光标所在行</td>
</tr>
<tr>
<td>nyy</td>
<td>复制光标所在行开始的 n 行</td>
</tr>
<tr>
<td>y1G</td>
<td>复制光标所在行到文件第一行间的内容</td>
</tr>
<tr>
<td>yG</td>
<td>复制光标所在行到文件最后一行间的内容</td>
</tr>
<tr>
<td>y\$</td>
<td>复制光标到行尾间的内容</td>
</tr>
<tr>
<td>y0</td>
<td>复制光标到行头间的内容</td>
</tr>
<tr>
<td>p(小写)</td>
<td>粘贴，如果复制的内容是一列，将粘贴到光标所在含的下一行</td>
</tr>
<tr>
<td>P(大写)</td>
<td>粘贴，如果复制的内容是一列，将粘贴到光标所在含的上一行</td>
</tr>
<tr>
<td>u</td>
<td>撤销</td>
</tr>
<tr>
<td>^r</td>
<td>恢复</td>
</tr>
<tr>
<td>.</td>
<td>重复刚才的操作</td>
</tr>
</tbody>
</table>
<h5 id="编辑模式-insert-mode"><a href="#编辑模式-insert-mode" class="headerlink" title="编辑模式(insert mode)"></a>编辑模式(insert mode)</h5><table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>i</td>
<td>进入编辑模式，并在光标处开始编辑</td>
</tr>
<tr>
<td>I</td>
<td>进入编辑模式，并在光标所在行头部开始编辑</td>
</tr>
<tr>
<td>a</td>
<td>进入编辑模式，并在光标处的后一个位置开始编辑</td>
</tr>
<tr>
<td>A</td>
<td>进入编辑模式，并在光标所在尾部开始编辑</td>
</tr>
<tr>
<td>o</td>
<td>进入编辑模式，并在光标所在行的下一行开始编辑</td>
</tr>
<tr>
<td>O</td>
<td>进入编辑模式，并在光标所在行的上一行开始编辑</td>
</tr>
<tr>
<td>r</td>
<td>进入替换模式，替换当前光标上的那个字</td>
</tr>
<tr>
<td>R</td>
<td>进入替换模式，可一直替换，直到按下 Esc</td>
</tr>
</tbody>
</table>
<h5 id="命令行模式-command-line-mode"><a href="#命令行模式-command-line-mode" class="headerlink" title="命令行模式(command-line mode)"></a>命令行模式(command-line mode)</h5><table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>:w</td>
<td>将编辑的数据写入硬盘</td>
</tr>
<tr>
<td>:w!</td>
<td>强行写入硬盘，即使没有写入权限。前提是当前的用户有修改权限的能力</td>
</tr>
<tr>
<td>:q</td>
<td>离开</td>
</tr>
<tr>
<td>:q!</td>
<td>强制离开，不保存</td>
</tr>
<tr>
<td>:wq</td>
<td>保存后离开</td>
</tr>
<tr>
<td>:wq!</td>
<td>强制保存后离开</td>
</tr>
<tr>
<td>:wq!</td>
<td>强制保存后离开</td>
</tr>
<tr>
<td>ZZ</td>
<td>若文件没改动就不储存离开，如果有改动就储存再离开</td>
</tr>
<tr>
<td>:! command</td>
<td>可以输入命令行界面的命令</td>
</tr>
<tr>
<td>:w [filename]</td>
<td>将文件另存为</td>
</tr>
<tr>
<td>:n1,n2 w [filename]</td>
<td>将文件 n1 到 n2 行间的内容另存为</td>
</tr>
<tr>
<td>:r [filename]</td>
<td>读取其他文件并插入到当前光标的下一行</td>
</tr>
<tr>
<td>:set nu</td>
<td>设置行号</td>
</tr>
<tr>
<td>:set nonu</td>
<td>取消行号</td>
</tr>
</tbody>
</table>
<h5 id="多文件编辑功能"><a href="#多文件编辑功能" class="headerlink" title="多文件编辑功能"></a>多文件编辑功能</h5><p>当用 vim file1 file2 …同时打开多个文件时，可使用多文件编辑功能。</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>:files</td>
<td>查看当前这个 vim 打开的所有文件</td>
</tr>
<tr>
<td>:n</td>
<td>查看下一个文件</td>
</tr>
<tr>
<td>:N</td>
<td>查看前一个文件</td>
</tr>
</tbody>
</table>
<h5 id="多窗口功能"><a href="#多窗口功能" class="headerlink" title="多窗口功能"></a>多窗口功能</h5><p>多窗口功能非常的方便，能让我买在同一 bash 中并列查看多个文件。</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>:sp [filename]</td>
<td>在新窗口中打开文件，如果不加名字就将当前文件在新窗口中打开</td>
</tr>
<tr>
<td>^w+down</td>
<td>切到下一个窗口</td>
</tr>
<tr>
<td>^w+up</td>
<td>切到上一个窗口</td>
</tr>
</tbody>
</table>
<h5 id="文字补全功能"><a href="#文字补全功能" class="headerlink" title="文字补全功能"></a>文字补全功能</h5><p>例如在 htm 的 style 标签内些 css 时忘记了背景颜色的 css 名字，就可以用文字补全功能了。</p>
<table>
<thead>
<tr>
<th>组合按钮</th>
<th>补齐的内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>^x-&gt;^n</td>
<td>通过目前正在编辑的这个“文件的内容文字”作为关键字，予以补齐</td>
</tr>
<tr>
<td>^x-&gt;^f</td>
<td>以当前目录内的“文件名”作为关键字，予以补齐</td>
</tr>
<tr>
<td>^x-&gt;^o</td>
<td>以扩展名作为语法补充，以 vim 内置的关键字，予以补齐</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://allenmrbai.github.io/2019/02/28/Linux文件权限/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="博主">
      <meta itemprop="description" content="记录学习的过程">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/Linux文件权限/" class="post-title-link" itemprop="url">Linux文件权限</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建于：2019-02-28 15:11:50" itemprop="dateCreated datePublished" datetime="2019-02-28T15:11:50+08:00">2019-02-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="更新于：2025-04-24 17:20:11" itemprop="dateModified" datetime="2025-04-24T17:20:11+08:00">2025-04-24</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Linux 下文件与文件夹的各个权限对应的意义是不同的，这篇文章主要写出文件与文件夹的可读、可写、可执行权限对应的功能。</p>
<h4 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h4><h6 id="1-可读"><a href="#1-可读" class="headerlink" title="1.可读"></a>1.可读</h6><p>可以读取文件内的文本，二进制码等文件的内容，前提是能进入该文件所在的文件夹。</p>
<h6 id="2-可写"><a href="#2-可写" class="headerlink" title="2.可写"></a>2.可写</h6><p>可以添加，删除，修改文件的内容，前提是能进入该文件所在的文件夹。</p>
<h6 id="3-可执行"><a href="#3-可执行" class="headerlink" title="3.可执行"></a>3.可执行</h6><p>可以执行该文件，前提是能进入该文件所在的文件夹。</p>
<h4 id="文件夹"><a href="#文件夹" class="headerlink" title="文件夹"></a>文件夹</h4><h6 id="1-可读-1"><a href="#1-可读-1" class="headerlink" title="1.可读"></a>1.可读</h6><p>可以用 ls 列出文件的名称。</p>
<h6 id="2-可读"><a href="#2-可读" class="headerlink" title="2.可读"></a>2.可读</h6><p>可以对在文件夹下添加、删除文件和文件夹，还能修改文件或文件夹的名字。</p>
<h6 id="3-可执行-1"><a href="#3-可执行-1" class="headerlink" title="3.可执行"></a>3.可执行</h6><p>可以进入该文件夹。</p>
<h4 id="综合"><a href="#综合" class="headerlink" title="综合"></a>综合</h4><h6 id="1-ll-不能列出详细信息，只能看到文件名"><a href="#1-ll-不能列出详细信息，只能看到文件名" class="headerlink" title="1.ll 不能列出详细信息，只能看到文件名"></a>1.ll 不能列出详细信息，只能看到文件名</h6><p>当文件夹对当前用户只有可读权限时，使用”ll”命令列出该文件下所有文件的详细信息时，除了文件名外都是问号。文件夹添加当前用户的可执行权限即可看到全部详细。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://allenmrbai.github.io/2019/02/28/Shell/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="博主">
      <meta itemprop="description" content="记录学习的过程">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/Shell/" class="post-title-link" itemprop="url">Shell</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建于：2019-02-28 15:10:45" itemprop="dateCreated datePublished" datetime="2019-02-28T15:10:45+08:00">2019-02-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="更新于：2025-04-24 17:20:11" itemprop="dateModified" datetime="2025-04-24T17:20:11+08:00">2025-04-24</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="什么是-shell"><a href="#什么是-shell" class="headerlink" title="什么是 shell"></a>什么是 shell</h3><p>为了避免非专业人士直接操作系统导致系统受破坏，因此需要有个 shell 来操作。每个命令都是一个应用，shell 是一个能调用各个应用接口的程序。</p>
<h5 id="shell-的命令"><a href="#shell-的命令" class="headerlink" title="shell 的命令"></a>shell 的命令</h5><p>可以用 type 命令来查看那些命令是 shell 内置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> <span class="built_in">cd</span> <span class="comment">#cd是shell内置的</span></span><br></pre></td></tr></table></figure>
<p>如果命令过长，可以用‘\’将回车转义(escape)，这样就可以在下一行继续输入命令。</p>
<p>有时候需要删除和编辑写好的命令,可以通过下面的组合键操作。</p>
<table>
<thead>
<tr>
<th>组合键</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>^u</td>
<td>删除光标处到头部的内容</td>
</tr>
<tr>
<td>^k</td>
<td>删除光标处到尾部的内容</td>
</tr>
<tr>
<td>^a</td>
<td>到命令头部</td>
</tr>
<tr>
<td>^e</td>
<td>到命令尾部</td>
</tr>
</tbody>
</table>
<h3 id="shell-的变量功能"><a href="#shell-的变量功能" class="headerlink" title="shell 的变量功能"></a>shell 的变量功能</h3><p>获得变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#shell中获取变量需要在变量前加$</span></span><br><span class="line"><span class="comment">#打印HOME变量</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$HOME</span></span><br></pre></td></tr></table></figure>
<p>设置变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">variable=value</span><br><span class="line"><span class="comment">#设置变量myname的值为Allen</span></span><br><span class="line">myname=Allen</span><br></pre></td></tr></table></figure>
<p>删除变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">unset</span> variable</span><br></pre></td></tr></table></figure>
<h5 id="变量的设置规则"><a href="#变量的设置规则" class="headerlink" title="变量的设置规则"></a>变量的设置规则</h5><ul>
<li>变量名由字母、数字、下划线组成，并且不能由数字开头</li>
<li>变量赋值等号左右两侧不能由空格，如“name = allenbai”或“name=allen bai”</li>
<li>如果变量的值内要包含空格需要用‘“’或‘’’来包裹,或‘\’转义。如“name=”hello world””,“name=hello\ world”。注意如果使用的是单引号，那么单引号的内容就会变成一般的字符，里面定义的变量就会失去意义。如“name=’${name} is you’”,这里的“${name}”会变成字符，而不是变量。</li>
<li>如果在赋值的过程中引用变量需要“”$变量名””或“${变量名}”。如“name=”$name”love”或“name=${name}love”</li>
<li>如果需要其他指令提供的信息，可以用反单引号“`指令`”或“$(指令)”。如“name=$(uname -r)”</li>
<li>“export variable”可以将变量导到环境变量中。可以用“env”查看所有环境变量</li>
<li>系统的变量默认全大写，自己的变量可以用小写，以便区分。这点要不要遵守看个人偏好。</li>
<li>“unset varaible”可以取消变量</li>
</ul>
<h5 id="范例"><a href="#范例" class="headerlink" title="范例"></a>范例</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#进入到目前的核心目录模块</span></span><br><span class="line"><span class="built_in">cd</span> /lib/modules/`uname -r`/kernal</span><br><span class="line"><span class="built_in">cd</span> /lib/modules/$(uname -r)/kernal</span><br><span class="line"><span class="comment">#列出crontab相关文件的权限</span></span><br><span class="line">ls -ld `locate crontab`</span><br><span class="line">ls -ld $(locate crontab)</span><br></pre></td></tr></table></figure>
<h5 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h5><p>查看当前环境变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看当前环境变量</span></span><br><span class="line">env</span><br></pre></td></tr></table></figure>
<p>export 不加参数也可以查看当前环境的变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span></span><br></pre></td></tr></table></figure>
<p>如果需要查看包括自定义变量和环境变量在内的所有变量可以用 set</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#不带任何参数即可</span></span><br><span class="line"><span class="comment">#貌似我安装的CentOS 7内无法显示变量</span></span><br><span class="line"><span class="built_in">set</span></span><br></pre></td></tr></table></figure>
<p>一些需要了解的系统环境变量</p>
<ul>
<li>HOME 代表使用者的主文件夹</li>
<li>SHELL 当前环境用的是哪个 shell</li>
<li>HISTSIZE 能被系统记录的历史指令的数量</li>
<li>MAIL 当前用户的邮件信箱文件</li>
<li>PATH 可执行文件搜索的路径</li>
<li>LANG 语系数据</li>
<li>RANDOM 随机数变量。值介于 0~32767 之间。如果要取得 0~9 之间可以这样：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">declare</span> -i number=<span class="variable">$RANDOM</span>*10/32768;<span class="built_in">echo</span> <span class="variable">$number</span></span><br></pre></td></tr></table></figure>
<p>bash 不只有环境变量，还有一些 bash 操作接口有关的变量，以及自定义的变量。用 set 可以观察所有变量。</p>
<p>除了环境变量外，其他 bash 内的变量</p>
<ul>
<li>PS1 提示字符的设置</li>
<li>\$ shell 的 PID</li>
<li>? 关于上个指令的回传值，0 表示成功，如果上个指令执行报错，会回传错误代码</li>
<li>OSTYPE,HOSTTYPE,MACHTYPE 主机硬件</li>
</ul>
<p>环境变量与自订变量的差别是该变量是否会被子程序继续引用。</p>
<h5 id="语系变量"><a href="#语系变量" class="headerlink" title="语系变量"></a>语系变量</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">locale</span><br></pre></td></tr></table></figure>
<h5 id="变量的有效范围"><a href="#变量的有效范围" class="headerlink" title="变量的有效范围"></a>变量的有效范围</h5><p>鸟哥书里提到的环境变量和自订变量也可以称为全局变量(global variable)和局部变量(local variable)。</p>
<h5 id="read-array-declare"><a href="#read-array-declare" class="headerlink" title="read,array,declare"></a>read,array,declare</h5><p>read 可以读取来自键盘输入的变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line"><span class="built_in">read</span> [-pt] variable</span><br><span class="line"><span class="comment">#-p :后面可以接提示字符</span></span><br><span class="line"><span class="comment">#-t :后面可以接等待的“秒数”</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#请用户输入用户名</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">'请在30秒内输入用户名'</span> -t 30 user_name</span><br></pre></td></tr></table></figure>
<p>declare/typeset 设置变量类型</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line"><span class="built_in">declare</span> [-aixr] variable</span><br><span class="line"><span class="comment">#-a :将变量声明为数组array</span></span><br><span class="line"><span class="comment">#-i :将变量声明为整数integer</span></span><br><span class="line"><span class="comment">#-x :将变量声明为环境变量</span></span><br><span class="line"><span class="comment">#-r :将变量声明为readonly类型，改变量不可更改内容，也不可以unset</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#以下两种变量声明结果不同</span></span><br><span class="line">sum=100+300+50;<span class="built_in">echo</span> <span class="variable">$sum</span> <span class="comment">#结果是 100+300+50</span></span><br><span class="line"><span class="built_in">declare</span> -i sum=100+300+50;<span class="built_in">echo</span> <span class="variable">$sum</span> <span class="comment">#结果是 450</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将-改成+ 可以进行取消的操作</span></span><br><span class="line"><span class="built_in">declare</span> +x sum</span><br></pre></td></tr></table></figure>
<p>定义数组</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">person[1]=<span class="string">'allen'</span></span><br><span class="line">person[2]=<span class="string">'jack'</span></span><br><span class="line">person[3]=<span class="string">'jane'</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;person[1]&#125;</span>,<span class="variable">$&#123;person[2]&#125;</span>,<span class="variable">$&#123;person[3]&#125;</span>"</span></span><br></pre></td></tr></table></figure>
<h5 id="变量的删除、取代和替换"><a href="#变量的删除、取代和替换" class="headerlink" title="变量的删除、取代和替换"></a>变量的删除、取代和替换</h5><p>从前面开始删除变量中的某些内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法 变量名+‘#’+匹配规则(pattern)</span></span><br><span class="line"><span class="comment">#这里的‘#’表示从最前面开始向右删，且删最短的那个</span></span><br><span class="line"><span class="variable">$&#123;variable#pattern&#125;</span></span><br><span class="line"><span class="comment">#如果要删除最长的要写‘##’,有点像正则表达式内的贪婪匹配</span></span><br><span class="line"><span class="variable">$&#123;variable##pattern&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line"><span class="comment">#/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin:/home/allen/.local/bin:/home/allen/bin</span></span><br><span class="line"><span class="comment">#删除/usr/local/bin:这个串</span></span><br><span class="line"><span class="variable">$&#123;PATH#/*local/bin:&#125;</span></span><br><span class="line"><span class="comment">#删除前面所有目录，保留最后一个。注意这里是‘##’,如果是‘#’的话，它只删掉第一个</span></span><br><span class="line"><span class="variable">$&#123;PATH##/*:&#125;</span></span><br></pre></td></tr></table></figure>
<p>从后面开始删除变量中的某些内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#从后面开始向左删，且删最短的那个。用法与‘#’类似</span></span><br><span class="line"><span class="variable">$&#123;variable%pattern&#125;</span></span><br><span class="line"><span class="comment">#同样的，如果要删尽可能多的内容，是‘%%’</span></span><br><span class="line"><span class="variable">$&#123;variable%%pattern&#125;</span></span><br></pre></td></tr></table></figure>
<p>替换内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法 pattern是指匹配规则 new是新内容</span></span><br><span class="line"><span class="variable">$&#123;variable/pattern/new&#125;</span></span><br><span class="line"><span class="comment">#全部替换</span></span><br><span class="line"><span class="variable">$&#123;variable//pattern/new&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将匹配到的第一个sbin替换为大写的SBIN</span></span><br><span class="line"><span class="variable">$&#123;PATH/sbin/SBIN&#125;</span></span><br><span class="line"><span class="comment">#如果要全部替换，第一个 ‘/’要写成‘//’</span></span><br><span class="line"><span class="variable">$&#123;PATH//sbin/SBIN&#125;</span></span><br></pre></td></tr></table></figure>
<h5 id="变量的测试与内容替换"><a href="#变量的测试与内容替换" class="headerlink" title="变量的测试与内容替换"></a>变量的测试与内容替换</h5><p>‘-’</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果old_var未定义 则new_var的值为content</span></span><br><span class="line">new_var=<span class="variable">$&#123;old_var-content&#125;</span></span><br></pre></td></tr></table></figure>
<p>有点像 js 里的管道符号</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> new_var = old_var || content;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果old_var未定义或为空值 则new_var的值为content</span></span><br><span class="line"><span class="comment">#注意这里多了个‘:’</span></span><br><span class="line">new_var=<span class="variable">$&#123;old_var:-content&#125;</span></span><br></pre></td></tr></table></figure>
<p>‘+’</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果old_var有定义(包括空值) 则new_var的值为content</span></span><br><span class="line">new_var=<span class="variable">$&#123;old_var+content&#125;</span></span><br></pre></td></tr></table></figure>
<p>有点像 js 里的‘&amp;&amp;’</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> new_var = old_var &amp;&amp; content;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果old_var有定义且值不为空 则new_var的值为content</span></span><br><span class="line"><span class="comment">#注意这里多了个‘:’</span></span><br><span class="line">new_var=<span class="variable">$&#123;old_var:+content&#125;</span></span><br></pre></td></tr></table></figure>
<p>‘=’</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这个效果和‘-’一样，但多了一个效果，就是content赋值给new_var的同时也会赋值给old_var</span></span><br><span class="line">new_var=<span class="variable">$&#123;old_var=content&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这个效果和‘:-’一样，但多了一个效果，就是content赋值给new_var的同时也会赋值给old_var</span></span><br><span class="line"><span class="comment">#注意这里多了个‘:’</span></span><br><span class="line">new_var=<span class="variable">$&#123;old_var:=content&#125;</span></span><br></pre></td></tr></table></figure>
<p>‘?’</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果old_var未定义 就会告知控制台warn的内容</span></span><br><span class="line">new_var=<span class="variable">$&#123;old_var?warn&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果old_var未定义或空值 就会告知控制台warn的内容</span></span><br><span class="line"><span class="comment">#注意这里多了个‘:’</span></span><br><span class="line">new_var=<span class="variable">$&#123;old_var:?warn&#125;</span></span><br></pre></td></tr></table></figure>
<p>其实不难发现‘-’,‘=’,‘?’都是假设 old_var 未定义才生效的，如果需要 old_var 为空值也生效加个‘:’就好。</p>
<p>而‘+’是假设 old_var 已定义才生效(无论有没有值)，如果需要 old_var 为空值不生效加个‘:’就好。</p>
<h3 id="命令别名与历史命名"><a href="#命令别名与历史命名" class="headerlink" title="命令别名与历史命名"></a>命令别名与历史命名</h3><h5 id="命令别名"><a href="#命令别名" class="headerlink" title="命令别名"></a>命令别名</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看所有命令别名</span></span><br><span class="line"><span class="built_in">alias</span></span><br><span class="line"><span class="comment"># 生成命令别名</span></span><br><span class="line"><span class="built_in">alias</span> comand_name=<span class="string">'comand'</span></span><br><span class="line"><span class="comment">#例子 命令别名是lm,指令是‘ls -al | more’</span></span><br><span class="line"><span class="built_in">alias</span> lm=<span class="string">'ls -al | more'</span></span><br><span class="line"><span class="comment"># 删除命令别名</span></span><br><span class="line"><span class="built_in">unalias</span> comand_name</span><br><span class="line"><span class="comment">#例子 删除命令别名 lm</span></span><br><span class="line"><span class="built_in">unalias</span> lm</span><br></pre></td></tr></table></figure>
<h3 id="bash-的环境配置文件"><a href="#bash-的环境配置文件" class="headerlink" title="bash 的环境配置文件"></a>bash 的环境配置文件</h3><h5 id="重要的环境配置文件"><a href="#重要的环境配置文件" class="headerlink" title="重要的环境配置文件"></a>重要的环境配置文件</h5><table>
<thead>
<tr>
<th>配置文件</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>/etc/issue</td>
<td>bash 的开机画面</td>
</tr>
<tr>
<td>/etc/motd</td>
<td>bash 登录后的提示信息</td>
</tr>
<tr>
<td>/etc/locale.conf</td>
<td>决定默认使用语系，由/etc/profile.d/lang.sh 调用进来</td>
</tr>
<tr>
<td>/etc/profile</td>
<td>登录 bash 时读取的文件，是系统整体的设置</td>
</tr>
<tr>
<td>/etc/profile.d/*.sh</td>
<td>/etc/profile 运行时回去执行/etc/profile.d 下所有.sh 结尾的文件</td>
</tr>
<tr>
<td>/usr/share/bash-completion/completions/*</td>
<td>Tab 的补全设置，由/etc/profile.d/bash_completion.sh 调用进来</td>
</tr>
<tr>
<td>~/.bash_profile 或 ~/.bash_login 或 ~/.profile</td>
<td>属于使用者个人的设置。其实只会读取其中的一个。最先读取~/.bash_profile，如果没有再读取下一个，以此类推</td>
</tr>
<tr>
<td>~/.bashrc</td>
<td>获取 no-login shell 时会读取该文件。还有~/.bash_profile 会读该文件</td>
</tr>
<tr>
<td>~/.bash_history</td>
<td>历史命令记录的地方</td>
</tr>
<tr>
<td>~/.bash_logout</td>
<td>登出的时候执行的文件</td>
</tr>
</tbody>
</table>
<h5 id="读入环境配置文件的指令"><a href="#读入环境配置文件的指令" class="headerlink" title="读入环境配置文件的指令"></a>读入环境配置文件的指令</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line"><span class="built_in">source</span> 配置文件文件名</span><br><span class="line"><span class="comment">#例子 当修改了~/.bash_profile时需要登出再登录后才生效，为了让设置生效可以用source指令</span></span><br><span class="line"><span class="built_in">source</span> ~/.bash_profile</span><br><span class="line"><span class="comment">#soucrce指令也可以写成‘.’</span></span><br><span class="line">. ~/.bash_profile</span><br></pre></td></tr></table></figure>
<h3 id="万用字符和特殊符号"><a href="#万用字符和特殊符号" class="headerlink" title="万用字符和特殊符号"></a>万用字符和特殊符号</h3><h5 id="万用字符"><a href="#万用字符" class="headerlink" title="万用字符"></a>万用字符</h5><p>万用字符有点像正则匹配有点类似但有差别</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td>*</td>
<td>代表 0 到无穷个任意字符，相当于正则的.*</td>
</tr>
<tr>
<td>?</td>
<td>随机的一个字符</td>
</tr>
<tr>
<td>[]</td>
<td>表示括号内的任意一个字符</td>
</tr>
<tr>
<td>[-]</td>
<td>字符编码范围，例如[0-9]表示 0 到 9 之间的所有字符</td>
</tr>
<tr>
<td>[^]</td>
<td>反向选择，例如[^abc]表示非 a,b,c 的字符</td>
</tr>
</tbody>
</table>
<h5 id="特殊符号"><a href="#特殊符号" class="headerlink" title="特殊符号"></a>特殊符号</h5><table>
<thead>
<tr>
<th>符号</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td>#</td>
<td>注释符号</td>
</tr>
<tr>
<td>\</td>
<td>转义</td>
</tr>
<tr>
<td>\</td>
<td></td>
<td>管线(pipe),分隔两个管线命令的界定</td>
</tr>
<tr>
<td>;</td>
<td>连续指令下达分隔符号</td>
</tr>
<tr>
<td>~</td>
<td>使用者的主文件夹</td>
</tr>
<tr>
<td>\$</td>
<td>取用变量前置字符：亦即是变量之前需要加的变量取代值</td>
</tr>
<tr>
<td>&amp;</td>
<td>工作控制 （job control）：将指令变成背景下工作</td>
</tr>
<tr>
<td>!</td>
<td>逻辑运算符,not 的意思</td>
</tr>
<tr>
<td>/</td>
<td>目录符号：路径分隔的符号</td>
</tr>
<tr>
<td>>和>></td>
<td>数据流重导向：输出导向，分别是“取代”与“累加”</td>
</tr>
<tr>
<td>\&lt;和\&lt;\&lt;</td>
<td>数据流重导向：输入导向</td>
</tr>
<tr>
<td>‘ ‘</td>
<td>单引号，不具有变量置换的功能 （\$ 变为纯文本）</td>
</tr>
<tr>
<td>“ “</td>
<td>具有变量置换的功能！ （\$ 可保留相关功能）</td>
</tr>
<tr>
<td>`</td>
<td>两个“`”中间为可以先执行的指令，亦可使用 \$（ ）</td>
</tr>
<tr>
<td>（）</td>
<td>在中间为子 shell 的起始与结束</td>
</tr>
<tr>
<td>{ }</td>
<td>在中间为命令区块的组合！</td>
</tr>
</tbody>
</table>
<h5 id="数据流重导向"><a href="#数据流重导向" class="headerlink" title="数据流重导向"></a>数据流重导向</h5><p>数据流重导向就是将某个指令执行后应该要出现在屏幕上的数据， 给他传输到<br>其他的地方，例如文件或者是设备。</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td>\&lt;</td>
<td>标准输入，将某个文件代替键盘输入</td>
</tr>
<tr>
<td>\&lt;\&lt;</td>
<td>标准输入，以某个符号作为文件的结束标记</td>
</tr>
<tr>
<td>>或 1></td>
<td>标准输出,覆盖原内容</td>
</tr>
<tr>
<td>>>或 1>></td>
<td>标准输出，添加的原内容尾部</td>
</tr>
<tr>
<td>2></td>
<td>标准错误输出,覆盖原内容</td>
</tr>
<tr>
<td>2>></td>
<td>标准错误输出，添加的原内容的尾部</td>
</tr>
</tbody>
</table>
<p>以下是例子</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#例 将ll列出的内容保存到~/rootfile内</span></span><br><span class="line">ll / &gt; ~/rootfile</span><br><span class="line"></span><br><span class="line"><span class="comment">#例 创建catfile文件并将~/.bashrc的内容给它</span></span><br><span class="line">cat &gt; catfile &lt; ~/.bashrc</span><br><span class="line"></span><br><span class="line"><span class="comment">#原来cat不仅仅只有读文件的功能，不加参数还会读取键盘录入</span></span><br><span class="line"><span class="comment">#例 用cat命令新建catfile，并以键盘的录入内容作为该文件的内容。想要结束输入按^d。</span></span><br><span class="line">cat &gt; catfile</span><br><span class="line"></span><br><span class="line"><span class="comment">#例 用cat命令新建catfile，并以‘eof’做为结束标记。</span></span><br><span class="line">cat &gt; catfile &lt;&lt; <span class="string">'eof'</span> <span class="comment">#当你输入eof回车时，就和按^d的效果是一样的</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#例 使用find指令时，遇到没有读取权限的文件会报错，通过2\&gt;将错误导到/dev/null</span></span><br><span class="line">find /home -name .bashrc 2&gt; /dev/null <span class="comment">#/dev/null相当于垃圾桶黑洞</span></span><br><span class="line"><span class="comment">#例 将正确和错误的数据都写入同一个文件</span></span><br><span class="line">find /home -name .bashrc &gt; list 2&gt; &amp;1</span><br><span class="line"><span class="comment">#或者这么写</span></span><br><span class="line">find /home -name .bashrc &amp;&gt; list</span><br></pre></td></tr></table></figure>
<h5 id="和-amp-amp-和"><a href="#和-amp-amp-和" class="headerlink" title=";和&amp;&amp;和||"></a>;和&amp;&amp;和||</h5><p>‘;’这个很好理解，相当于每个语句的结束符。有了它，就可以同时写个条指令了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#例 关机前执行两次sync同步写入磁盘</span></span><br><span class="line">sync;sync;shutdown -h now</span><br></pre></td></tr></table></figure>
<p>&amp;&amp;前后连接两个指令，前一个指令报错就不执行后一个指令；||前后连接两个指令，前一个不报错就不执行后一个指令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#非root用户执行find /root，$?返回错误代码，所这里的ls不执行</span></span><br><span class="line">find /root &amp;&amp; ls</span><br><span class="line"><span class="comment">#这里的ls会执行</span></span><br><span class="line">find /root || ls</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#我们要在tmp下面创建/abc/hehe，但我们不知道abc是否存在。于是我们可以用下面的方法。</span></span><br><span class="line">ls /tmp/abc || mkdir /tmp/abc &amp;&amp; touch /tmp/abc/hehe</span><br></pre></td></tr></table></figure>
<h6 id="解析："><a href="#解析：" class="headerlink" title="解析："></a>解析：</h6><p>情况一，tmp 下没 abc 文件夹。</p>
<p>由于没有 abc 文件夹，那第一个指令回传值（\$?）不为 0，也就是说第一个指令报错了，于是会执行第二指令新建 abc 目录。第二个指令执行成功，于是会执行第三个指令创建 hehe 文件。</p>
<p>情况二，tmp 下有 abc 文件夹。<br>第一个指令成功，所以第二个指令不执行。注意了，这行语句并没有就此结束。第一个回传值会继续传递，由于第一个回传值是 0，所以第三个指令会执行。</p>
<p>结论：无论有没有 abc 目录，我们都能创建/tmp/abc/hehe 文件</p>
<h5 id="管线符号-pipe"><a href="#管线符号-pipe" class="headerlink" title="管线符号(pipe)"></a>管线符号(pipe)</h5><p>‘|’就是管线符号了。如果数据流重导向是将指令的结果导到设备和文件或设备和文件的数据导到指令的话；那么 pipe 就是将前一个命令的数据输出做为后一个命令的输入。<br>使用管线符号需要注意两点：</p>
<ol>
<li>管线符号后面的那个命令必须是管线命令。能接受前一个指令的数据成为 standard input 才是管线命令。</li>
<li>管线命令仅会处理 standard output，对于 standard error output 会被忽略。</li>
</ol>
<h5 id="管线符号的组合运用"><a href="#管线符号的组合运用" class="headerlink" title="管线符号的组合运用"></a>管线符号的组合运用</h5><ul>
<li>cut</li>
</ul>
<p>cut 可以将数据按我们的要求切出来，可以想象成 split。该命令是按行来操作的。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法一；按分隔字符将一行数据切成多段，并攫取其中的几个片段</span></span><br><span class="line">cut -d <span class="string">'分隔字符'</span> -f 分段区间</span><br><span class="line"><span class="comment">#例 将$PATH按‘:’分隔，并取第一段和第4段</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;PATH&#125;</span> | cut -d <span class="string">':'</span> -f 1,4</span><br><span class="line"><span class="comment">#例 将$PATH按‘:’分隔，并取第4段到最后一段</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;PATH&#125;</span> | cut -d <span class="string">':'</span> -f 4-</span><br><span class="line"><span class="comment">#例 用last查看登录者信息，只显示登陆者名称</span></span><br><span class="line">last | cut -d <span class="string">' '</span> -f 1</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法二；</span></span><br><span class="line">cut -c 字符区间</span><br><span class="line"><span class="comment">#例 将export的信息前面 declare -x的字去掉</span></span><br><span class="line"><span class="built_in">export</span> | cut -c 12-</span><br></pre></td></tr></table></figure>
<ul>
<li>grep</li>
</ul>
<p>查询每一行，把含有我们想要的文字的句子列出来。grep 能配合正则使用。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">grep [-acinv] [--color=auto] <span class="string">'搜寻字符'</span> filename</span><br><span class="line"><span class="comment">#选项与参数：</span></span><br><span class="line"><span class="comment">#-a ：将 binary 文件以 text 文件的方式搜寻数据</span></span><br><span class="line"><span class="comment">#-c ：计算找到 '搜寻字串' 的次数</span></span><br><span class="line"><span class="comment">#-i ：忽略大小写的不同，所以大小写视为相同</span></span><br><span class="line"><span class="comment">#-n ：顺便输出行号</span></span><br><span class="line"><span class="comment">#-v ：反向选择，亦即显示出没有 '搜寻字串' 内容的那一行！</span></span><br><span class="line"><span class="comment">#--color=auto ：可以将找到的关键字部分加上颜色的显示喔！</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#例 将last中出现root的那行取出</span></span><br><span class="line">last | grep <span class="string">'root'</span></span><br><span class="line"><span class="comment">#例 取出 /etc/man_db.conf 内含 MANPATH 的那几行</span></span><br><span class="line">grep --color=auto <span class="string">'MANPATH'</span> /etc/man_db.conf</span><br></pre></td></tr></table></figure>
<ul>
<li>sort</li>
</ul>
<p>sort 很明显是用来排序的。排序的字符和语系有关，因此， 如果您需要排<br>序时，建议使用 LANG=C 来让语系统一，数据排序比较好一些。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">sort [-fbMnrtuk] [file or stdin]</span><br><span class="line"><span class="comment">#选项与参数：</span></span><br><span class="line"><span class="comment">#-f ：忽略大小写的差异，例如 A 与 a 视为编码相同；</span></span><br><span class="line"><span class="comment">#-b ：忽略最前面的空白字符部分；</span></span><br><span class="line"><span class="comment">#-M ：以月份的名字来排序，例如 JAN, DEC 等等的排序方法；</span></span><br><span class="line"><span class="comment">#-n ：使用“纯数字”进行排序（默认是以文字体态来排序的）；</span></span><br><span class="line"><span class="comment">#-r ：反向排序；</span></span><br><span class="line"><span class="comment">#-u ：就是 uniq ，相同的数据中，仅出现一行代表；</span></span><br><span class="line"><span class="comment">#-t ：分隔符号，默认是用 [tab] 键来分隔；</span></span><br><span class="line"><span class="comment">#-k ：以那个区间 （field） 来进行排序的意思</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#例 将/etc/passwd下的账号进行排序</span></span><br><span class="line">cat /etc/passwd | sort</span><br><span class="line"></span><br><span class="line"><span class="comment">#例 /etc/passwd内容是以‘:’分隔的，我们想用第三栏来排序</span></span><br><span class="line">cat /etc/passwd | sort -t <span class="string">':'</span> -k 3</span><br><span class="line"></span><br><span class="line"><span class="comment">#取出last中的所有账号，并排序</span></span><br><span class="line">last | cut -d <span class="string">' '</span> -f1 | sort</span><br></pre></td></tr></table></figure>
<ul>
<li>uniq</li>
</ul>
<p>将排序完的数据去重。（只有连续的重复内容才会被去除，所以使用前需要排序）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">uniq [-ic]</span><br><span class="line"><span class="comment">#选项与参数：</span></span><br><span class="line"><span class="comment">#-i ：忽略大小写字符的不同；</span></span><br><span class="line"><span class="comment">#-c ：进行计数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#例 将last取出的账号排序并除重</span></span><br><span class="line">last | cut -d <span class="string">' '</span> -f1 | sort | uniq</span><br><span class="line"><span class="comment">#例 如果要在上个例子的基础上加上计数</span></span><br><span class="line">last | cut -d <span class="string">' '</span> -f1 | sort | uniq -c</span><br></pre></td></tr></table></figure>
<ul>
<li>wc</li>
</ul>
<p>查看文件多少行，多少个字符</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">wc [-lwm]</span><br><span class="line"><span class="comment">#选项与参数：</span></span><br><span class="line"><span class="comment">#-l ：仅列出行；</span></span><br><span class="line"><span class="comment">#-w ：仅列出多少字（英文单字）；</span></span><br><span class="line"><span class="comment">#-m ：多少字符；</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看/etc/man_db.conf里面有多少岁字、行、字符</span></span><br><span class="line">cat /etc/man_db.conf | wc</span><br></pre></td></tr></table></figure>
<ul>
<li>tee</li>
</ul>
<p>我们可以使用数据流重导向‘&gt;’将 stdout 输入到文件。如果我们在输入到文件的同时，还要继续使用这个 stdout 的话，我们可使用 tee（双向重导向）。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">tee [-a] file</span><br><span class="line"><span class="comment">#选项与参数：</span></span><br><span class="line"><span class="comment">#-a ：以累加 （append） 的方式，将数据加入 file 当中！</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#例 将last输出一份到last.list</span></span><br><span class="line">last | tee last.list | cut -d <span class="string">" "</span> -f1</span><br></pre></td></tr></table></figure>
<ul>
<li>unix2dos dos2unix</li>
</ul>
<p>unix2dos 是将文本的 unix 换行符号换成 dos 的。</p>
<ul>
<li>tr</li>
</ul>
<p>删除或替换文本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">tr [-ds] SET1 ...</span><br><span class="line"><span class="comment">#选项与参数：</span></span><br><span class="line"><span class="comment">#-d ：删除讯息当中的 SET1 这个字串；</span></span><br><span class="line"><span class="comment">#-s ：取代掉重复的字符！</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#例 将last输出的信息中所有的小写变成大写</span></span><br><span class="line">last | tr [a-z] [A-Z]</span><br><span class="line"><span class="comment">#例 将/etc/passwd输出的小写中的冒号‘:’删除</span></span><br><span class="line">cat /etc/passwd | tr -d <span class="string">':'</span></span><br><span class="line"><span class="comment">#例 将/etc/passd转存成dos断行到/root/passwd中，再将^M符号删除</span></span><br><span class="line">cp /etc/passwd ~/passwd &amp;&amp; unix2dos ~/passwd</span><br><span class="line"><span class="comment">#例 上面那个方法可以用tr的方法来代替。^M可以用\r来代替</span></span><br><span class="line">cat ~/passwd | tr -d <span class="string">'\r'</span> &gt; ~/passwd.linux</span><br></pre></td></tr></table></figure>
<ul>
<li>col</li>
</ul>
<p>将 tab 转成对等的空白键</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">col [-xb]</span><br><span class="line"></span><br><span class="line"><span class="comment">#cat -A可以看到tab的符号为^I</span></span><br><span class="line">cat -A /etc/man_db.conf</span><br><span class="line"><span class="comment">#将/etc/man_db.conf的tab转为空白键后再cat -A查看</span></span><br><span class="line">cat /etc/man_db.conf | col -x | cat -A | more</span><br></pre></td></tr></table></figure>
<ul>
<li>join</li>
</ul>
<p>将含有相同数据的行拼接在一起。使用时最好排序下。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">join [-ti12]</span><br><span class="line"><span class="comment">#选项与参数：</span></span><br><span class="line"><span class="comment">#-t ：join 默认以空白字符分隔数据，并且比对“第一个字段”的数据，</span></span><br><span class="line"><span class="comment">#如果两个文件相同，则将两笔数据联成一行，且第一个字段放在第一个！</span></span><br><span class="line"><span class="comment">#-i ：忽略大小写的差异；</span></span><br><span class="line"><span class="comment">#-1 ：这个是数字的 1 ，代表“第一个文件要用那个字段来分析”的意思；</span></span><br><span class="line"><span class="comment">#-2 ：代表“第二个文件要用那个字段来分析”的意思。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#例 用root 的身份，将 /etc/passwd 与 /etc/shadow 相关数据整合成一栏</span></span><br><span class="line">join -t <span class="string">':'</span> /etc/passwd /etc/shadow | head -n 3</span><br><span class="line"><span class="comment">#例 ：我们知道 /etc/passwd 第四个字段是 GID ，那个 GID 记录在/etc/group 当中的第三个字段，请问如何将两个文件整合？</span></span><br><span class="line">join -t <span class="string">':'</span> -1 4 /etc/passwd -2 3 /etc/group | head -n 3</span><br></pre></td></tr></table></figure>
<ul>
<li>paste</li>
</ul>
<p>paste 比 join 简单粗暴，它直接将两个文件的行相连，并用 tab 隔开</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">paste [-d] file1 file2</span><br><span class="line"><span class="comment">#选项与参数：</span></span><br><span class="line"><span class="comment">#-d ：后面可以接分隔字符。默认是以 [tab] 来分隔的！</span></span><br><span class="line"><span class="comment">#- ：如果 file 部分写成 - ，表示来自 standard input 的数据的意思。</span></span><br></pre></td></tr></table></figure>
<ul>
<li>expand</li>
</ul>
<p>将 tab 转成空白键</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">expand [-t] file</span><br><span class="line"><span class="comment">#选项与参数：</span></span><br><span class="line"><span class="comment">#-t ：后面可以接数字。一般来说，一个 tab 按键可以用 8 个空白键取代。</span></span><br><span class="line"><span class="comment">#我们也可以自行定义一个 [tab] 按键代表多少个字符呢！#</span></span><br></pre></td></tr></table></figure>
<ul>
<li>split</li>
</ul>
<p>他可以帮你将一个大文件，依据文件大小或行数来分区，就可以将大文件分区成为小文件了！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">split [-bl] file PREFIX</span><br><span class="line"><span class="comment">#选项与参数：</span></span><br><span class="line"><span class="comment">#-b ：后面可接欲分区成的文件大小，可加单位，例如 b, k, m 等；</span></span><br><span class="line"><span class="comment">#-l ：以行数来进行分区。</span></span><br><span class="line"><span class="comment">#PREFIX ：代表前置字符的意思，可作为分区文件的前导文字。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#例 我的 /etc/services 有六百多K，若想要分成 300K 一个文件时？</span></span><br><span class="line"><span class="built_in">cd</span> /tmp; split -b 300k /etc/services services</span><br><span class="line"><span class="comment">#例 将上面分割出来的三个文件合成一个文件，名为servicesback</span></span><br><span class="line">cat services* &gt;&gt; servicesback</span><br><span class="line"></span><br><span class="line"><span class="comment">#例 使用ls -al / 输出的信息中，没十行记录成一个文件</span></span><br><span class="line">ls -al | split -l 10 - lsroot</span><br></pre></td></tr></table></figure>
<ul>
<li>xargs</li>
</ul>
<p>xargs 可以读入 stdin 的数据，并且以空白字符或断行字符作为分辨，将 stdin 的数据分隔成为 arguments</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">xargs [-0epn] <span class="built_in">command</span></span><br><span class="line"><span class="comment">#选项与参数：</span></span><br><span class="line"><span class="comment">#-0 ：如果输入的 stdin 含有特殊字符，例如 `, \, 空白键等等字符时，这个 -0 参数可以将他还原成一般字符。这个参数可以用于特殊状态喔！</span></span><br><span class="line"><span class="comment">#-e ：这个是 EOF （end of file） 的意思。后面可以接一个字串，当 xargs分析到这个字串时，就会停止继续工作！</span></span><br><span class="line"><span class="comment">#-p ：在执行每个指令的 argument 时，都会询问使用者的意思；</span></span><br><span class="line"><span class="comment">#-n ：后面接次数，每次 command 指令执行时，要使用几个参数的意思。当 xargs后面没有接任何的指令时，默认是以 echo 来进行输出喔！</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#例 取出/etc/passwd中的前三个用户，并依次对每个用户执行id命令</span></span><br><span class="line">cut -d <span class="string">':'</span> -f 1 /etc/passwd | head -n 3 | xargs -n 1 id</span><br></pre></td></tr></table></figure>
<ul>
<li>-</li>
</ul>
<p>在管线命令的使用中‘-’是非常重要的，它指代前一个命令的标准输出</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir /tmp/homeback</span><br><span class="line">tar -cvf - /home | tar -xvf - -C /tmp/homeback</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://allenmrbai.github.io/2019/02/28/Linux常用命令/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="博主">
      <meta itemprop="description" content="记录学习的过程">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/Linux常用命令/" class="post-title-link" itemprop="url">Linux常用命令</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建于：2019-02-28 14:53:27" itemprop="dateCreated datePublished" datetime="2019-02-28T14:53:27+08:00">2019-02-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="更新于：2025-04-24 17:20:11" itemprop="dateModified" datetime="2025-04-24T17:20:11+08:00">2025-04-24</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>以下是阅读鸟哥的 Linux 私房菜第四版做的笔记。</p>
<h4 id="一、Linux-入门"><a href="#一、Linux-入门" class="headerlink" title="一、Linux 入门"></a>一、Linux 入门</h4><h5 id="1-man-命令"><a href="#1-man-命令" class="headerlink" title="1. man 命令"></a>1. man 命令</h5><p>虽然绝大多数数的命令带有–help 选项，但是想查看某命令的详细信息还是 man 比较详细。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">man man <span class="comment">#查看man命令的manual</span></span><br><span class="line">man 1 man <span class="comment">#查看id为1的man命令</span></span><br><span class="line">man -f man <span class="comment">#查看命令名中包含man字样的所有命令</span></span><br><span class="line">man -k man <span class="comment">#查看命令简介中包含man字样的所有命令</span></span><br></pre></td></tr></table></figure>
<h5 id="2-info-命令"><a href="#2-info-命令" class="headerlink" title="2.info 命令"></a>2.info 命令</h5><p>虽然 man 命令很强大，但是一大段的文字在 bash 中展现出来难免难以查阅。info 命令将 man 的内容拆成多个 node 可以让使用者像操作 html 一样来查看命令的使用详情。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">info info <span class="comment">#查看info命令的.info文件</span></span><br></pre></td></tr></table></figure>
<p>进入 info 的使用界面，为了方便操作，info 的使用界面带有很多快捷键。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">n <span class="comment">#Next 跳到下一个Node</span></span><br><span class="line">p <span class="comment">#prev 跳到上一个Node</span></span><br><span class="line">] <span class="comment">#下一节点，与n不同的是，n会略过子节点直接跳到下一个统计节点，]不会</span></span><br><span class="line">[ <span class="comment">#上一节点，效果和]差不多</span></span><br><span class="line">u <span class="comment">#Up 上一节点</span></span><br><span class="line">b 或 Home <span class="comment">#Begining 会到节点顶部</span></span><br><span class="line">e 或 End <span class="comment">#End 回到节点底部</span></span><br><span class="line">空格 或 PgDn <span class="comment">#向下移动一个屏幕高度，相当翻页</span></span><br><span class="line">回车 会 Del 或PgUp <span class="comment">#向上移动一个屏幕高度</span></span><br><span class="line">Tab <span class="comment">#跳到下一个最近的链接</span></span><br><span class="line">m <span class="comment">#链接跳转，需要input 链接的名字</span></span><br><span class="line">? <span class="comment">#查看更多的操作快捷键</span></span><br></pre></td></tr></table></figure>
<h4 id="二、文件权限"><a href="#二、文件权限" class="headerlink" title="二、文件权限"></a>二、文件权限</h4><h5 id="1-改变文件属性和权限"><a href="#1-改变文件属性和权限" class="headerlink" title="1.改变文件属性和权限"></a>1.改变文件属性和权限</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chgrp <span class="comment">#change group</span></span><br><span class="line">chown <span class="comment">#change owner</span></span><br><span class="line">chmod <span class="comment"># change mode</span></span><br></pre></td></tr></table></figure>
<h6 id="1-改变文件所属组"><a href="#1-改变文件所属组" class="headerlink" title="1.改变文件所属组"></a>1.改变文件所属组</h6><p>Linux 的所有组的信息保留在/etc/group 文件内。该文件内的内容格式为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#组名:密码:组id:组内所有成员</span></span><br><span class="line">group_name:passwd:GID:user_list</span><br></pre></td></tr></table></figure>
<p>为了安全，密码实际显示的是”X”，真正的密码保存在了/etc/shadow 内(该文件只有 root 才能打开)。</p>
<p>修改文件所属组方法如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">chgrp [options] group file ...</span><br></pre></td></tr></table></figure>
<h6 id="2-改变文件所属用户"><a href="#2-改变文件所属用户" class="headerlink" title="2.改变文件所属用户"></a>2.改变文件所属用户</h6><p>linux 的所有用户信息保留在/etc/passwd 文件内。改文件内的内容格式为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用户名:密码:用户id:用户的主要组id:可选字段，通常为了存放信息:home目录所在地址:shell</span></span><br><span class="line">account:password:UID:GID:GECOS:directory:shell</span><br></pre></td></tr></table></figure>
<p>同样，这里的密码显示的是’x’.</p>
<p>修改文件所属用户的方法如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">chown [options] user[:group] file ...</span><br><span class="line"><span class="comment">#修改index.html所属用户为allen</span></span><br><span class="line">chown allen index.html</span><br><span class="line"><span class="comment">#修改index.html所属组为root</span></span><br><span class="line">chown :root index.html</span><br><span class="line"><span class="comment">#递归修改index.html所属组为root所属用户为allen</span></span><br><span class="line">chown -R allen:root index.html</span><br></pre></td></tr></table></figure>
<h6 id="3-改变文件权限"><a href="#3-改变文件权限" class="headerlink" title="3.改变文件权限"></a>3.改变文件权限</h6><p>修改文件的权限有两种方法，数字和符号</p>
<ol>
<li>数字</li>
</ol>
<p>r:4 w:2 x:1,根据需要，将权限对应的数字相加即可得到一个数字。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">chmod [options] mode file ...</span><br><span class="line"><span class="comment">#将index.html 的权限改为rwxr-xr--</span></span><br><span class="line">chmod 754 index.html</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>符号</li>
</ol>
<p>a:所有对象 u:所属用户 g:所属组 o:其他人，根据需要，将对应的权限赋值给对应的对象就好</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">chmod [options] mode file ...</span><br><span class="line"><span class="comment">#将index.html 的权限改为rwxrwxrwx</span></span><br><span class="line">chmod a=rwx index.html</span><br></pre></td></tr></table></figure>
<p>如果想去掉或添加某个对象的某个权限，可以用’-‘和’+’</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#index.html的权限为rwxrwxrwx,现在想去掉其他用户的可执行权限</span></span><br><span class="line">chmod o-x index.html</span><br><span class="line"><span class="comment">#index.html的权限为rwxrwxrw-,现在想添加其他用户的可执行权限</span></span><br><span class="line">chmod o+x index.html</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>隐藏权限</li>
</ol>
<p>在老的 Ext 文件系统上，可以添加与查看隐藏权限,在 xfs 文件系统(CentOS 7 默认)内仅支持部分参数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chattr <span class="comment">#添加隐藏权限</span></span><br><span class="line">isattr <span class="comment">#查看隐藏权限</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>默认权限 umask</li>
</ol>
<p>用户创建文件和文件是都会带有默认的权限。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">umask</span> <span class="comment">#查看默认权限 4位数</span></span><br><span class="line"><span class="built_in">umask</span> -S <span class="comment">#查看默认权限 标识符的形式</span></span><br></pre></td></tr></table></figure>
<p>一般用户的默认 umask 是 0002，要如何解读这 4 位数呢。第一位是特殊权限的位置，后三位就是我们平时理解的 user group others。但是有所不同的是显示的数字是表示要排除的特权。</p>
<p>最后一位是 2，那表是要排除掉可写权限。于是 0002 对于新创建的文件，它的默认权限是-rw-rw-r;对于新创建的目录，它的默认权限是-rwxrwxr-x。</p>
<p>注意这里的文件和目录的默认权限有所不同，文件本身就默认没有可执行权限的，而目录默认是有可执行权限。因为对大部分文件来说，可执行权限没有意义，但对于目录来说就很有必要。</p>
<p>root 用户的默认 umask 是 0022，这是为了安全考虑，这样 root 创建的文件或目录，在默认情况下，其同组成员是无法修改的。</p>
<ol start="5">
<li>特殊权限</li>
</ol>
<p>SUID SGID TBIT 是三个特殊权限。</p>
<p>有时候会看到 rwsr-xr-x 的权限，这里的 s 就是 SUID。该权限的作用就是其他用户在执行的时候可以获得该文件所属用户的权限(注意仅在文件执行期间)。，SUID 仅可用在 binary program 上， 不能够用在 shell script 上面！以下是设置方法。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将权限为 rwxr-xr-x的test修改为rwsr-xr-x</span></span><br><span class="line">chmod 4755 <span class="built_in">test</span></span><br></pre></td></tr></table></figure>
<p>有时候会看到 rwx–s–x 的权限，这里的 s 就是 SUID。其作用类似 SUID,就是在文件的执行期间其他用户可以获得该程序群组的支持。</p>
<p>SUID 同时也可以用在目录上，其作用就是使用者进入该目录时，它的有效群组会变为该目录的群组。同时，使用者在该目录下创建的文件群组和该目录的群组相同。</p>
<p>以下是设置方法。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将权限为 rwxr-xr-x的test修改为rwxr-sr-x</span></span><br><span class="line">chmod 2755 <span class="built_in">test</span></span><br></pre></td></tr></table></figure>
<p>查看/tmp 的权限是，会看到 drwxrwxrwt,这个 t，这里的 t 就是 TBIT。它可以让使用者在它下面创建的文件仅有使用者自己和 root 能删除。</p>
<p>以下是设置方法。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将权限为 rwxr-xr-x的test修改为rwxr-xr-t</span></span><br><span class="line">chmod 1755 <span class="built_in">test</span></span><br></pre></td></tr></table></figure>
<p>其实权限设置是有 4 位的，第一位表示的是特殊权限。SUID:4,SGID:2,TBIT:1。把他们相应的数字相加就能组合使用。注意如果出现大写的 S 或 T，那说明这是无效的特殊权限，因为其所在的位置没有设置可执行权限。</p>
<h4 id="三、文件与目录管理"><a href="#三、文件与目录管理" class="headerlink" title="三、文件与目录管理"></a>三、文件与目录管理</h4><h5 id="1-路径与文件、目录管理"><a href="#1-路径与文件、目录管理" class="headerlink" title="1.路径与文件、目录管理"></a>1.路径与文件、目录管理</h5><h6 id="1-路径"><a href="#1-路径" class="headerlink" title="1.路径"></a>1.路径</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> <span class="comment">#变换目录</span></span><br><span class="line"><span class="built_in">pwd</span> <span class="comment">#显示当前的路径</span></span><br></pre></td></tr></table></figure>
<p>特殊的目录一览</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">. <span class="comment">#代表此层目录</span></span><br><span class="line">.. <span class="comment">#代表上一层目录</span></span><br><span class="line">- <span class="comment">#代表前一个工作目录</span></span><br><span class="line">~ <span class="comment">#代表“目前使用者身份”所在的主文件夹</span></span><br><span class="line">~account <span class="comment">#代表 account 这个使用者的主文件夹（account是个帐号名称）</span></span><br></pre></td></tr></table></figure>
<h6 id="2-文件、目录管理"><a href="#2-文件、目录管理" class="headerlink" title="2.文件、目录管理"></a>2.文件、目录管理</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mkdir <span class="comment">#创建文件夹</span></span><br><span class="line">rmdir <span class="comment">#移除文件夹</span></span><br><span class="line">touch <span class="comment">#创建文件，也可以用来刷新文件的mtime ctime atime</span></span><br><span class="line">ls <span class="comment">#查看目录下的文件</span></span><br><span class="line">rm <span class="comment">#删除文件</span></span><br><span class="line">mv <span class="comment">#移动文件 可以替代rename的功能</span></span><br><span class="line">cp <span class="comment">#拷贝</span></span><br><span class="line">file <span class="comment">#查看文件类型 如sticky directory</span></span><br></pre></td></tr></table></figure>
<h5 id="2-文件内容查看"><a href="#2-文件内容查看" class="headerlink" title="2.文件内容查看"></a>2.文件内容查看</h5><p>查看文件内容可以用各种编辑器例如 nano、vim 等。在 X window 下还可以用 gedit 编辑器。</p>
<p>如果仅仅只是查看文件，用编辑器就有点小题大做。linux 有直接查看文件的命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cat <span class="comment">#查看文件</span></span><br><span class="line">tac <span class="comment">#从文件尾部开始查看文件，与cat相反</span></span><br><span class="line">nl <span class="comment">#带行号的文件查看</span></span><br><span class="line">more <span class="comment">#带翻页的查看</span></span><br><span class="line">less <span class="comment">#也是带翻页的查看，比more强大，man page默认的就是less</span></span><br><span class="line">head <span class="comment">#查看文件头部</span></span><br><span class="line">tail <span class="comment">#查看文件尾部，通常加个-f选项可以watch文件的变化，可用来查看logger文件</span></span><br><span class="line">od <span class="comment">#查看二进制文件</span></span><br></pre></td></tr></table></figure>
<h5 id="3-指令文件名的搜索"><a href="#3-指令文件名的搜索" class="headerlink" title="3.指令文件名的搜索"></a>3.指令文件名的搜索</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">which</span> <span class="comment">#查看指令的可执行文件所在目录，它是按PATH的所规范的路径寻找</span></span><br><span class="line"><span class="built_in">type</span> <span class="comment">#which查不到的，可能是bash自带的指令，此时就可以用type来查了</span></span><br></pre></td></tr></table></figure>
<h5 id="4-文件的查找"><a href="#4-文件的查找" class="headerlink" title="4.文件的查找"></a>4.文件的查找</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">find <span class="comment">#强大的查找功能，但比较消耗性能和时间</span></span><br><span class="line">whereis <span class="comment">#由于只搜索某几个目录，所以比find速度快</span></span><br><span class="line">locate <span class="comment">#通过数据库查询，所以比较快。但是有时候，有些文件还没更新到数据库内，会导致查不到。</span></span><br><span class="line">updatedb <span class="comment">#手动更新数据库 方便locate查找</span></span><br></pre></td></tr></table></figure>
<h4 id="四、磁盘与文件系统管理"><a href="#四、磁盘与文件系统管理" class="headerlink" title="四、磁盘与文件系统管理"></a>四、磁盘与文件系统管理</h4><h5 id="1-查看文件系统的-superblock"><a href="#1-查看文件系统的-superblock" class="headerlink" title="1.查看文件系统的 superblock"></a>1.查看文件系统的 superblock</h5><p>ext 文件系统</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dumpe2fs [options] 设备文件名</span><br></pre></td></tr></table></figure>
<p>xfs 文件系统</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xfs_info 挂载点 | 设备文件名</span><br></pre></td></tr></table></figure>
<h5 id="2-查看磁盘或目录的容量"><a href="#2-查看磁盘或目录的容量" class="headerlink" title="2.查看磁盘或目录的容量"></a>2.查看磁盘或目录的容量</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df <span class="comment">#列出文件系统的整体磁盘使用量</span></span><br><span class="line">du <span class="comment">#评估文件系统的使用量</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">df [options] [目录或文件名]</span><br><span class="line"><span class="comment">#将系统内所有的filesystem列出来</span></span><br><span class="line">df -h</span><br><span class="line"><span class="comment">#查看/etc目录的可用的磁盘容量列出</span></span><br><span class="line">df -h /etc</span><br><span class="line"><span class="comment">#将目前各个partition当中可用的inode数量列出</span></span><br><span class="line">df -ih</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">du [options] [目录或文件名]</span><br><span class="line"><span class="comment">#列出目前目录下的所有目录的大小</span></span><br><span class="line">du</span><br><span class="line"><span class="comment">#列出目前目录下的所有文件和目录的大小</span></span><br><span class="line">du -a</span><br></pre></td></tr></table></figure>
<h5 id="3-创建连接"><a href="#3-创建连接" class="headerlink" title="3.创建连接"></a>3.创建连接</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">ln [-sf] 来源文件 目标文件</span><br><span class="line">-s <span class="comment">#不带该参数，默认是创建实体连接(hard link)加上是创建符号连接(symbol link)</span></span><br></pre></td></tr></table></figure>
<h5 id="4-查看磁盘分区情况"><a href="#4-查看磁盘分区情况" class="headerlink" title="4.查看磁盘分区情况"></a>4.查看磁盘分区情况</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看磁盘分区情况</span></span><br><span class="line">lsblk [options] [device]</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看分区uuid</span></span><br><span class="line">blkid</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#列出磁盘的分区表类型与分区信息</span></span><br><span class="line">parted device_name <span class="built_in">print</span></span><br></pre></td></tr></table></figure>
<h5 id="5-磁盘分区：gdisk-fdisk"><a href="#5-磁盘分区：gdisk-fdisk" class="headerlink" title="5.磁盘分区：gdisk/fdisk"></a>5.磁盘分区：gdisk/fdisk</h5><p>注意 MBR 分区表用 fdisk;GPT 分区表用 gdisk。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gdisk 设备名</span><br></pre></td></tr></table></figure>
<p>分区完毕并写入后，分区表并没有更新。可以通过重启来更新，或者 partprobe 更新 linux 核心的分区表信息。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">partprobe [-s]</span><br></pre></td></tr></table></figure>
<p>我们可以用 lsblk 来查看分区表的姿态，也可以：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/partitions <span class="comment">#核心的分区纪录</span></span><br></pre></td></tr></table></figure>
<h5 id="5-磁盘格式化"><a href="#5-磁盘格式化" class="headerlink" title="5.磁盘格式化"></a>5.磁盘格式化</h5><p>make filesysytem 创建文件系统即是格式化。</p>
<p>这部分理解比较吃力，请查阅鸟哥的 linux 382 页</p>
<p>格式化为 xfs 文件系统</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfs.xfs  [-b bsize] [-d parms] [-i parms] [-l parms] [-L label] [-f] [-r parms] 设备名</span><br></pre></td></tr></table></figure>
<p>格式化为 ext4 文件系统</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfs.ext4 [-b size] [-L label] 设备名称</span><br></pre></td></tr></table></figure>
<p>格式化为其他文件系统</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkfs</span><br><span class="line"><span class="comment">#查看支持的文件系统</span></span><br><span class="line">mkfs[tab][tab]</span><br></pre></td></tr></table></figure>
<h5 id="6-文件系统挽救"><a href="#6-文件系统挽救" class="headerlink" title="6.文件系统挽救"></a>6.文件系统挽救</h5><p>每个文件系统都有其对应的指令</p>
<p>xfs</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xfs_repair [-fnd] 设备名称</span><br></pre></td></tr></table></figure>
<p>ext4。fsck.ext4 这是个综合指令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fsck.ext4 [-pf] [-b superblock] 设备名称</span><br></pre></td></tr></table></figure>
<h5 id="7-文件系统挂载与卸载"><a href="#7-文件系统挂载与卸载" class="headerlink" title="7.文件系统挂载与卸载"></a>7.文件系统挂载与卸载</h5><p>进行挂载前要确定好几件事：</p>
<ul>
<li>单一文件系统不应该被重复挂载在不同的挂载点（目录）中；</li>
<li>单一目录不应该重复挂载多个文件系统；</li>
<li>要作为挂载点的目录，理论上应该都是空目录才是。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount <span class="comment">#比较复杂 请用man来查看</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#鸟哥现在比较推荐UUID的方式来挂载，应为UUID是唯一标识符，不会发生重复</span></span><br><span class="line"><span class="comment">#挂载前用blkid查看要挂载的分区的UUID</span></span><br><span class="line">blkid</span><br><span class="line"><span class="comment">#然后通过UUID进行挂载到对应的目录，注意该目录必须要存在</span></span><br><span class="line">mount UUID=<span class="string">'分区的UUID'</span> 目录</span><br></pre></td></tr></table></figure>
<p>有挂载就有卸载</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">umount [-fn] 设备文件名或挂载点</span><br></pre></td></tr></table></figure>
<h5 id="7-磁盘-文件系统参数修订"><a href="#7-磁盘-文件系统参数修订" class="headerlink" title="7.磁盘/文件系统参数修订"></a>7.磁盘/文件系统参数修订</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mknod</span><br><span class="line">xfs_admin <span class="comment">#修改 XFS 文件系统的 UUID 与 Label name</span></span><br><span class="line">tune2fs <span class="comment">#修改 ext4 的 label name 与 UUID</span></span><br></pre></td></tr></table></figure>
<p>一个有趣的命令 uuidgen</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uuidgen <span class="comment">#生成一个新的uuid</span></span><br></pre></td></tr></table></figure>
<h5 id="8-开机挂载-etc-fstab-及-etc-mtab"><a href="#8-开机挂载-etc-fstab-及-etc-mtab" class="headerlink" title="8.开机挂载 /etc/fstab 及 /etc/mtab"></a>8.开机挂载 /etc/fstab 及 /etc/mtab</h5><p>修改/etc/fstab 即可开机自动挂载</p>
<h4 id="五、文件与文件系统的压缩-打包与备份"><a href="#五、文件与文件系统的压缩-打包与备份" class="headerlink" title="五、文件与文件系统的压缩,打包与备份"></a>五、文件与文件系统的压缩,打包与备份</h4><h5 id="1-文件压缩"><a href="#1-文件压缩" class="headerlink" title="1.文件压缩"></a>1.文件压缩</h5><p>压缩指令 gzip,bzip2,xz</p>
<h6 id="1-gzip-zcat-zmore-zless-zgrep"><a href="#1-gzip-zcat-zmore-zless-zgrep" class="headerlink" title="1.gzip/zcat/zmore/zless/zgrep"></a>1.gzip/zcat/zmore/zless/zgrep</h6><p>gzip 同时可以解压 compress zip gzip 文件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">gizp [options] 压缩文件</span><br><span class="line"><span class="comment">#压缩文件，并查看压缩比</span></span><br><span class="line">gizp -v services</span><br><span class="line"><span class="comment">#保留原文件的文件名，并且创建压缩文件！</span></span><br><span class="line">gizp -c services &gt; services.gz</span><br><span class="line"><span class="comment">#解压</span></span><br><span class="line">gizp -d services.gz</span><br></pre></td></tr></table></figure>
<p>zcat/zmore/zless/zgrep 分别对应 cat/more/less/grep。用来直接查看压缩文件内容。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看services.gz的内容</span></span><br><span class="line">zcat services.gz</span><br><span class="line"><span class="comment">#查看压缩文件内带'http'字样的文本</span></span><br><span class="line">zgrep -n <span class="string">'http'</span> services.gz</span><br></pre></td></tr></table></figure>
<p>压缩的时候配合上 time 命令，还可以了解压缩用的时间。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">time gzip services</span><br></pre></td></tr></table></figure>
<h6 id="2-bzip2-bzcat-bzmore-bzless-bzgrep"><a href="#2-bzip2-bzcat-bzmore-bzless-bzgrep" class="headerlink" title="2.bzip2/bzcat/bzmore/bzless/bzgrep"></a>2.bzip2/bzcat/bzmore/bzless/bzgrep</h6><p>用法和 gizp 相同，更多信息可以 man 它。它的优点是压缩率比 gzip 更高，同时花的时间也会多一些。</p>
<h6 id="3-xz-xzcat-xzmore-xzless-xzgrep"><a href="#3-xz-xzcat-xzmore-xzless-xzgrep" class="headerlink" title="3.xz/xzcat/xzmore/xzless/xzgrep"></a>3.xz/xzcat/xzmore/xzless/xzgrep</h6><p>用法和 gizp/bzip2 相同，它的压缩比例比 bzip2 还要高，因此比较花费时间。</p>
<p>它还提供了一些更方便的 option</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#列出压缩文件详细息信息</span></span><br><span class="line">xz -l services.xz</span><br><span class="line"><span class="comment">#保留原文件的文件名，并且创建压缩文件！</span></span><br><span class="line">xz -k services</span><br></pre></td></tr></table></figure>
<h5 id="2-打包指令"><a href="#2-打包指令" class="headerlink" title="2.打包指令"></a>2.打包指令</h5><p>打包命令有点复杂，以下列出了常用的简单命令。高级用法请自行 man 它。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#压缩 将z改成j可以用bzip2压缩，改成J可以用xz压缩</span></span><br><span class="line">tar -zcv -f filename.tar.gz 要被压缩的文件或目录名称（可以多个,用空格隔开）</span><br><span class="line"><span class="comment">#查看压缩包</span></span><br><span class="line">tar -ztv -f filename.tar.gz</span><br><span class="line"><span class="comment">#解压</span></span><br><span class="line">tar -zxv -f filename.tar.gz [要解开的某个文件] -C 欲解压缩到的目录</span><br><span class="line"><span class="comment">#参数说明</span></span><br><span class="line">-z 通过gzip的支持进行压缩/解压</span><br><span class="line">-j 通过bzip2的支持进行压缩/解压</span><br><span class="line">-J 通过xz的支持进行压缩/解压</span><br><span class="line">-c 创建打包文件</span><br><span class="line">-t 查看打包文件</span><br><span class="line">-x 解开压缩包</span><br><span class="line">-v 列出压缩包内的文件</span><br><span class="line">-f 后面要立刻接要被处理的文件名！建议 -f 单独写一个选项啰！（比较不会忘记）</span><br><span class="line">-C 这个选项用在解压缩，若要在特定目录解压缩，可以使用这个选项。</span><br><span class="line"></span><br><span class="line">-p 保留备份数据的原本权限与属性，常用于备份（-c）重要的配置文件</span><br><span class="line">-P 保留绝对路径，亦即允许备份数据中含有根目录存在之意；</span><br></pre></td></tr></table></figure>
<p>tar 可以用来备份文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#备份/etc目录,这里的time命令只是为了查看时间开销</span></span><br><span class="line"><span class="comment">#p是为了保留原本的权限与属性。</span></span><br><span class="line">time tar -jcpv -f /root/etc.bar.bz2 /etc</span><br></pre></td></tr></table></figure>
<p>tar 可以取出压缩包内的某个文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#以上面备份好的文件为例</span></span><br><span class="line"><span class="comment">#我们先查看压缩包，找到要取出的文件</span></span><br><span class="line">tar -jt /root/etc.bar.bz2 | grep <span class="string">'shadow'</span></span><br><span class="line"><span class="comment">#发现要找的文件目录为 etc/shadow</span></span><br><span class="line"><span class="comment">#然后用下面的方法取出</span></span><br><span class="line">tar -jxv /root/etc.bar.bz2 etc/shadow</span><br></pre></td></tr></table></figure>
<p>tar 打包的时候可以将不需要的文件排除在外</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -jcv -f /root/system.tar.bz2 --exclude=/root/etc* --exclude=/root/sysytem.tar.bz2 /etc /root</span><br></pre></td></tr></table></figure>
<p>tar 可以仅备份比某个时刻要新的文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查找比/etc/passwd的变更日期还新的文件</span></span><br><span class="line">find /etc --newer /etc/passwd</span><br><span class="line"><span class="comment">#如果我们只备份比/etc/passwd新的内容，需要先知道/etc/passwd更变日期</span></span><br><span class="line">ll /etc/passwd</span><br><span class="line"><span class="comment">#/etc/passwd变更日期为2018/5/5</span></span><br><span class="line">bar -jcv -f /root/etc.newer.than.passwd.tar.bz2 --newer-mtime=<span class="string">"2018/05/05"</span> /etc/*</span><br></pre></td></tr></table></figure>
<h5 id="3-XFS-文件系统的备份与还原"><a href="#3-XFS-文件系统的备份与还原" class="headerlink" title="3.XFS 文件系统的备份与还原"></a>3.XFS 文件系统的备份与还原</h5><p>使用 tar 通常是针对目录系统来进行备份的工作，如果想针对整个 xfs 文件系统进行备份需要 xfsdump。</p>
<p>还原的话用 xfsrestore。</p>
<p>该部分内容比较麻烦，请看鸟哥第四版 8.5 部分。</p>
<p>拷贝还可以用 dd。dd 该方法是一个扇区一个扇区拷的。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd -<span class="keyword">if</span> input_file -of output_file -bs 每个block的大小(默认一个扇区的大小) count 多少个block</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="博主">
            
              <p class="site-author-name" itemprop="name">博主</p>
              <p class="site-description motion-element" itemprop="description">记录学习的过程</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">18</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">3</span>
                    <span class="site-state-item-name">标签</span>
                  
                </div>
              
            </nav>
          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2025</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Allen Bai</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.0.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.0"></script>

  <script src="/js/src/motion.js?v=7.0.0"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.0"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.0"></script>



  

  


  <script src="/js/src/bootstrap.js?v=7.0.0"></script>



  



  





  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
